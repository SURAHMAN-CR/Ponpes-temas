<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMP Islam Ibadurrahman Temas - Pendidikan Islami Berkualitas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* KEEP ALL EXISTING STYLES - TIDAK DIUBAH */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            scroll-behavior: smooth;
        }
        
        .hero {
            background-image: url('https://i.ibb.co.com/0RBBPY6c/Whats-App-Image-2025-10-26-at-15-01-40.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
        }

        .hero-overlay {
            background: rgba(0, 0, 0, 0.5);
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.3));
        }

        :root {
            --primary-color: #005EAA;
            --secondary-color: #E6F2FF;
            --accent-color: #FF6B00;
            --text-color: #333333;
            --light-gray: #F5F5F5;
            --success-color: #10B981;
            --warning-color: #F59E0B;
            --danger-color: #EF4444;
            --marketplace-color: #8B5CF6;
            --tabungan-color: #F59E0B;
        }
        
        .header-kemendikbud {
            background-color: var(--primary-color);
            color: white;
            padding: 8px 0;
            font-size: 14px;
        }
        
        .navbar-kemendikbud {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .btn-kemendikbud {
            background-color: var(--primary-color);
            color: white;
            border-radius: 8px;
            padding: 10px 24px;
            font-weight: 500;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-kemendikbud:hover {
            background-color: #004A87;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 94, 170, 0.2);
        }
        
        .section-title {
            color: var(--primary-color);
            font-weight: 600;
            position: relative;
            padding-bottom: 15px;
            margin-bottom: 30px;
            font-size: 2.5rem;
            text-align: center;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background-color: var(--accent-color);
            border-radius: 2px;
        }
        
        .card-kemendikbud {
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            background: white;
            height: 100%;
        }
        
        .card-kemendikbud:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.1);
            border-color: var(--primary-color);
        }
        
        .footer-kemendikbud {
            background: linear-gradient(135deg, #1A1A1A 0%, #2D2D2D 100%);
            color: white;
            padding: 50px 0 20px;
        }
        
        .footer-kemendikbud a {
            color: #CCCCCC;
            transition: color 0.3s;
            text-decoration: none;
        }
        
        .footer-kemendikbud a:hover {
            color: white;
        }
        
        .platform-container {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 40px 0;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            transform: translateY(-5px);
        }

        .interactive-btn {
            background: linear-gradient(45deg, var(--primary-color), #004A87);
            border: none;
            border-radius: 50px;
            color: white;
            padding: 14px 32px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
        }

        .interactive-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, #004A87, var(--primary-color));
        }
        
        .pulse-animation {
            animation: pulse 2s infinite ease-in-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .platform-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .platform-section.active {
            display: block;
        }
        
        .dashboard-nav.active {
            background: linear-gradient(45deg, var(--primary-color), #004A87);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .game-container {
            perspective: 1000px;
            cursor: pointer;
        }

        .game-card {
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
        }

        .game-card.flipped {
            transform: rotateY(180deg);
        }

        .game-front, .game-back {
            backface-visibility: hidden;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 16px;
            overflow: hidden;
        }

        .game-back {
            transform: rotateY(180deg);
            background: white;
            padding: 20px;
        }
        
        .quiz-option {
            transition: all 0.2s ease;
            border: 2px solid #E5E7EB;
            border-radius: 10px;
            padding: 16px;
            cursor: pointer;
        }
        
        .quiz-option:hover {
            background-color: var(--secondary-color);
            border-color: var(--primary-color);
        }
        
        .quiz-option.selected {
            background-color: var(--secondary-color);
            border-color: var(--primary-color);
        }
        
        .correct-answer {
            background: linear-gradient(45deg, var(--success-color), #34D399) !important;
            color: white;
            border-color: var(--success-color) !important;
        }

        .wrong-answer {
            background: linear-gradient(45deg, var(--danger-color), #F87171) !important;
            color: white;
            border-color: var(--danger-color) !important;
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            transition: stroke-dashoffset 0.5s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .menu-item {
            position: relative;
            padding: 8px 0;
        }

        .menu-item::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 3px;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        .menu-item:hover::after {
            width: 100%;
        }

        .learning-card {
            transition: all 0.3s ease;
            border-left: 5px solid var(--primary-color);
        }
        
        .learning-card:hover {
            transform: translateY(-5px) translateX(5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .floating-element {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(2deg); }
        }
        
        .learning-path {
            position: relative;
            padding: 40px 0;
        }

        .learning-path::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, #667eea, #764ba2);
            border-radius: 10px;
        }

        .module-card {
            transition: all 0.3s ease;
            border-left: 5px solid #667eea;
        }

        .module-card:hover {
            transform: translateX(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .drag-container {
            min-height: 200px;
            border: 2px dashed #667eea;
            border-radius: 16px;
            transition: all 0.3s ease;
            background: rgba(102, 126, 234, 0.05);
        }

        .drag-container.drag-over {
            background: rgba(102, 126, 234, 0.1);
            border-color: #764ba2;
        }

        .drag-item {
            cursor: move;
            transition: all 0.3s ease;
            user-select: none;
        }

        .drag-item.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }
        
        .achievement-badge {
            animation: bounce 2s ease infinite;
            transform-origin: center bottom;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-15px) scale(1.05); }
        }

        .typewriter {
            overflow: hidden;
            border-right: 4px solid var(--primary-color);
            white-space: nowrap;
            margin: 0 auto;
            animation: typing 3.5s steps(40, end), blink-caret 0.75s step-end infinite;
        }

        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: var(--primary-color) }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
            z-index: 10000;
            transform: translateX(120%);
            transition: transform 0.3s ease;
            border-left: 5px solid var(--success-color);
            max-width: 400px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-left-color: var(--success-color);
        }

        .toast.error {
            border-left-color: var(--danger-color);
        }

        .toast.warning {
            border-left-color: var(--warning-color);
        }

        .toast.info {
            border-left-color: var(--primary-color);
        }
        
        .ppdb-counter {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 5px 15px rgba(0, 94, 170, 0.2);
        }
        
        .payment-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .payment-badge.paid {
            background-color: #D1FAE5;
            color: #065F46;
        }
        
        .payment-badge.pending {
            background-color: #FEF3C7;
            color: #92400E;
        }
        
        .payment-badge.overdue {
            background-color: #FEE2E2;
            color: #991B1B;
        }
        
        .product-card {
            transition: all 0.3s ease;
            border: 1px solid #E5E7EB;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border-color: var(--marketplace-color);
        }
        
        .product-discount {
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(45deg, var(--danger-color), #DC2626);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .tabungan-card {
            transition: all 0.3s ease;
            border: 1px solid #E5E7EB;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .tabungan-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border-color: var(--tabungan-color);
        }
        
        @keyframes countUp {
            from { transform: translateY(10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .saldo-animation {
            animation: countUp 0.5s ease-out;
        }
        
        @media (max-width: 768px) {
            .hero-content h1 {
                font-size: 2rem;
            }
            
            .hero-content p {
                font-size: 1rem;
            }
            
            .section-title {
                font-size: 1.75rem;
            }
            
            .interactive-btn {
                padding: 12px 24px;
                font-size: 14px;
            }
            
            .glass-card {
                border-radius: 16px;
            }
            
            .ppdb-counter {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 480px) {
            .section-title {
                font-size: 1.5rem;
            }
            
            .header-kemendikbud .container {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .ppdb-counter {
                font-size: 2rem;
            }
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #E5E7EB;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 94, 170, 0.1);
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #374151;
        }

        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        .data-table th {
            background: var(--primary-color);
            color: white;
            padding: 16px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .data-table td {
            padding: 14px 16px;
            border-bottom: 1px solid #E5E7EB;
        }

        .data-table tr:hover {
            background: var(--secondary-color);
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            height: 100%;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 24px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 8px;
        }

        .stat-label {
            color: #6B7280;
            font-size: 14px;
            font-weight: 500;
        }

        .calendar-day {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .calendar-day:hover {
            background: var(--secondary-color);
        }

        .calendar-day.active {
            background: var(--primary-color);
            color: white;
        }

        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--danger-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 1.5s infinite;
        }

        .avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, var(--primary-color), var(--accent-color));
            border-radius: 3px;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            padding-left: 20px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -33px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--primary-color);
            border: 3px solid white;
            box-shadow: 0 0 0 3px var(--secondary-color);
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #6B7280;
        }

        .breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .breadcrumb a:hover {
            color: #004A87;
            text-decoration: underline;
        }

        .breadcrumb .separator {
            color: #9CA3AF;
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #374151;
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 14px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border-width: 5px;
            border-style: solid;
            border-color: #374151 transparent transparent transparent;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .pagination {
            display: flex;
            gap: 8px;
            align-items: center;
            justify-content: center;
        }

        .pagination-btn {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 1px solid #E5E7EB;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pagination-btn:hover {
            border-color: var(--primary-color);
            background: var(--secondary-color);
        }

        .pagination-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
            opacity: 1;
        }

        .accordion-item {
            border: 1px solid #E5E7EB;
            border-radius: 10px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .accordion-header {
            padding: 16px;
            background: white;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s ease;
        }

        .accordion-header:hover {
            background: var(--secondary-color);
        }

        .accordion-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .accordion-item.active .accordion-content {
            padding: 16px;
            max-height: 1000px;
        }

        .progress-bar {
            height: 8px;
            background: #E5E7EB;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            margin: 2px;
        }

        .tag-primary {
            background: var(--secondary-color);
            color: var(--primary-color);
        }

        .tag-success {
            background: #D1FAE5;
            color: var(--success-color);
        }

        .tag-warning {
            background: #FEF3C7;
            color: var(--warning-color);
        }

        .tag-danger {
            background: #FEE2E2;
            color: var(--danger-color);
        }

        .tag-marketplace {
            background: #EDE9FE;
            color: var(--marketplace-color);
        }

        .tag-tabungan {
            background: #FEF3C7;
            color: #92400E;
        }

        @media (prefers-color-scheme: dark) {
            .glass-card {
                background: rgba(30, 30, 30, 0.95);
                border-color: rgba(255, 255, 255, 0.1);
            }
            
            .stat-card {
                background: #1F2937;
                color: white;
            }
            
            .form-input {
                background: #374151;
                border-color: #4B5563;
                color: white;
            }
        }

        /* ===== SECURITY STYLES ===== */
        .security-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(45deg, #10B981, #059669);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 10;
        }
        
        .session-timeout-warning {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #F59E0B;
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            z-index: 9999;
            display: none;
            animation: slideIn 0.3s ease;
        }
        
        .two-factor-modal {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            max-width: 400px;
            text-align: center;
        }
        
        .qr-code-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            display: inline-block;
            margin: 20px 0;
            border: 2px solid #E5E7EB;
        }
        
        .otp-input {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            border: 2px solid #E5E7EB;
            border-radius: 10px;
            margin: 0 5px;
        }
        
        .otp-input:focus {
            border-color: #005EAA;
            box-shadow: 0 0 0 3px rgba(0, 94, 170, 0.1);
            outline: none;
        }
        
        .login-attempt {
            background: #FEF3C7;
            border-left: 4px solid #F59E0B;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .admin-table-actions {
            display: flex;
            gap: 8px;
        }
        
        .admin-table-actions button {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            transition: all 0.2s ease;
        }
        
        .admin-table-actions .edit-btn {
            background: #EFF6FF;
            color: #1D4ED8;
            border: 1px solid #BFDBFE;
        }
        
        .admin-table-actions .delete-btn {
            background: #FEF2F2;
            color: #DC2626;
            border: 1px solid #FECACA;
        }
        
        .admin-table-actions button:hover {
            transform: translateY(-2px);
        }
        
        .audit-log {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .audit-log-item {
            padding: 12px;
            border-bottom: 1px solid #E5E7EB;
            font-size: 14px;
        }
        
        .audit-log-item:last-child {
            border-bottom: none;
        }
        
        .audit-log-item.success {
            border-left: 4px solid #10B981;
        }
        
        .audit-log-item.warning {
            border-left: 4px solid #F59E0B;
        }
        
        .audit-log-item.error {
            border-left: 4px solid #EF4444;
        }
        
        .admin-chart {
            height: 300px;
            background: white;
            border-radius: 12px;
            padding: 20px;
        }
        
        .permission-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 500;
            margin: 2px;
        }
        
        .permission-admin {
            background: #FEE2E2;
            color: #DC2626;
        }
        
        .permission-guru {
            background: #E0E7FF;
            color: #4F46E5;
        }
        
        .permission-santri {
            background: #D1FAE5;
            color: #059669;
        }
        
        .permission-orangtua {
            background: #FEF3C7;
            color: #D97706;
        }
        
        .user-status {
            display: inline-flex;
            align-items: center;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 6px;
        }
        
        .status-active {
            background: #10B981;
        }
        
        .status-inactive {
            background: #9CA3AF;
        }
        
        .status-suspended {
            background: #EF4444;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .password-strength {
            height: 4px;
            background: #E5E7EB;
            border-radius: 2px;
            margin-top: 8px;
            overflow: hidden;
        }
        
        .password-strength-bar {
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .strength-weak { background: #EF4444; }
        .strength-fair { background: #F59E0B; }
        .strength-good { background: #10B981; }
        .strength-strong { background: #059669; }
        
        .login-history-item {
            padding: 12px;
            border-radius: 8px;
            background: #F9FAFB;
            margin-bottom: 8px;
            border-left: 4px solid #E5E7EB;
        }
        
        .login-history-item.success {
            border-left-color: #10B981;
        }
        
        .login-history-item.failed {
            border-left-color: #EF4444;
        }
        
        .security-settings {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #2196F3;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }

        .admin-tab-content {
            display: none;
        }

        .admin-tab-content.active {
            display: block;
        }

        /* ===== ABSENSI STYLES ===== */
        .absensi-card {
            border-left: 5px solid #3B82F6;
            transition: all 0.3s ease;
        }

        .absensi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.1);
        }

        .qr-scanner-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            height: 300px;
            background: #1F2937;
            border-radius: 16px;
            overflow: hidden;
            margin: 0 auto;
        }

        .qr-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .qr-frame {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border: 3px solid #3B82F6;
            border-radius: 12px;
            box-shadow: 0 0 0 1000px rgba(0, 0, 0, 0.7);
        }

        .attendance-status {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .attendance-present {
            background: #D1FAE5;
            color: #065F46;
        }

        .attendance-late {
            background: #FEF3C7;
            color: #92400E;
        }

        .attendance-absent {
            background: #FEE2E2;
            color: #991B1B;
        }

        .attendance-permission {
            background: #E0E7FF;
            color: #3730A3;
        }

        /* ===== NOTIFICATION STYLES ===== */
        .notification-bell {
            position: relative;
            cursor: pointer;
        }

        .notification-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            width: 400px;
            max-height: 500px;
            overflow-y: auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: none;
        }

        .notification-dropdown.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .notification-item {
            padding: 16px;
            border-bottom: 1px solid #E5E7EB;
            transition: background 0.2s ease;
            cursor: pointer;
        }

        .notification-item:hover {
            background: #F9FAFB;
        }

        .notification-item.unread {
            background: #EFF6FF;
            border-left: 4px solid #3B82F6;
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
        }

        .notification-icon.payment {
            background: #D1FAE5;
            color: #10B981;
        }

        .notification-icon.grade {
            background: #E0E7FF;
            color: #4F46E5;
        }

        .notification-icon.event {
            background: #FEF3C7;
            color: #F59E0B;
        }

        .notification-icon.task {
            background: #FCE7F3;
            color: #EC4899;
        }

        .notification-icon.attendance {
            background: #F3E8FF;
            color: #8B5CF6;
        }

        /* ===== WEBSOCKET STATUS ===== */
        .connection-status {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .connection-connected {
            background: #D1FAE5;
            color: #065F46;
        }

        .connection-disconnected {
            background: #FEE2E2;
            color: #991B1B;
        }

        .connection-connecting {
            background: #FEF3C7;
            color: #92400E;
        }

        /* ===== EMAIL/SMS TEMPLATE ===== */
        .email-template {
            background: white;
            border-radius: 12px;
            border: 1px solid #E5E7EB;
            max-width: 600px;
            margin: 0 auto;
        }

        .email-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 12px 12px 0 0;
        }

        .email-body {
            padding: 30px;
            line-height: 1.6;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Session Timeout Warning -->
    <div id="session-timeout-warning" class="session-timeout-warning">
        <div class="flex items-center justify-between">
            <div class="flex items-center">
                <i class="fas fa-clock mr-3 text-xl"></i>
                <div>
                    <p class="font-semibold">Sesi akan berakhir!</p>
                    <p class="text-sm opacity-90">Sisa waktu: <span id="session-countdown">05:00</span></p>
                </div>
            </div>
            <button onclick="extendSession()" class="ml-6 bg-white text-orange-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-colors">
                Perpanjang
            </button>
        </div>
    </div>

    <!-- Two Factor Authentication Modal -->
    <div id="two-factor-modal" class="modal-overlay">
        <div class="two-factor-modal">
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Two-Factor Authentication</h3>
            <p class="text-gray-600 mb-6">Masukkan kode verifikasi dari aplikasi authenticator</p>
            
            <div id="qr-code-section">
                <p class="text-sm text-gray-500 mb-4">Scan QR code dengan Google Authenticator</p>
                <div class="qr-code-container">
                    <div id="qr-code-placeholder" class="w-48 h-48 bg-gray-100 flex items-center justify-center">
                        <p class="text-gray-500">QR Code akan muncul di sini</p>
                    </div>
                </div>
                <p class="text-sm text-gray-500 mt-4">Atau masukkan kode manual: <span id="manual-code" class="font-mono font-bold">JBSWY3DPEHPK3PXP</span></p>
            </div>
            
            <div class="mt-8">
                <p class="text-sm text-gray-600 mb-4">Masukkan 6-digit kode</p>
                <div class="flex justify-center mb-6">
                    <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 1)">
                    <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 2)">
                    <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 3)">
                    <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 4)">
                    <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 5)">
                    <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 6)">
                </div>
                
                <div id="otp-error" class="text-red-600 text-sm mb-4 hidden">
                    <i class="fas fa-exclamation-circle mr-1"></i> Kode OTP tidak valid
                </div>
                
                <div class="flex justify-between">
                    <button onclick="cancelTwoFactor()" class="px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                        Batal
                    </button>
                    <button onclick="verifyTwoFactor()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        Verifikasi
                    </button>
                </div>
                
                <p class="text-sm text-gray-500 mt-6">
                    <i class="fas fa-info-circle mr-1"></i>
                    Tidak punya akses ke authenticator? 
                    <a href="#" class="text-blue-600 hover:text-blue-800" onclick="showRecoveryOptions()">Gunakan kode pemulihan</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Header atas dengan security badge -->
    <div class="header-kemendikbud relative">
        <div class="security-badge">
            <i class="fas fa-shield-alt mr-2"></i>SSL Secure
        </div>
        <!-- Keep existing header content -->
        <div class="container mx-auto px-4 flex justify-between items-center">
            <div class="flex flex-wrap gap-4 text-sm">
                <span class="flex items-center"><i class="fas fa-phone-alt mr-2"></i> (0341) 1234567</span>
                <span class="flex items-center"><i class="fas fa-envelope mr-2"></i> info@smpislamibadurrahman.id</span>
                <span class="flex items-center"><i class="fas fa-clock mr-2"></i> Senin - Jumat: 07:00 - 15:00</span>
            </div>
            <div class="flex space-x-4">
                <a href="#" class="text-white hover:text-gray-200 transition-colors"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="text-white hover:text-gray-200 transition-colors"><i class="fab fa-twitter"></i></a>
                <a href="#" class="text-white hover:text-gray-200 transition-colors"><i class="fab fa-instagram"></i></a>
                <a href="#" class="text-white hover:text-gray-200 transition-colors"><i class="fab fa-youtube"></i></a>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar-kemendikbud">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <img src="https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg" alt="Logo SMP Islam Ibadurrahman Temas" class="w-12 h-12 object-contain rounded-full border-2 border-white shadow-md">
                <div>
                    <a href="#home" class="text-xl font-bold text-gray-800 hover:text-blue-600 transition-colors">SMP Islam Ibadurrahman Temas</a>
                    <p class="text-xs text-gray-600">Pendidikan Islami Berkualitas</p>
                </div>
            </div>
            
            <div class="hidden lg:flex items-center space-x-8" id="desktop-menu">
                <a href="#home" class="text-gray-700 hover:text-blue-600 font-medium menu-item py-2">Beranda</a>
                <a href="#profile" class="text-gray-700 hover:text-blue-600 font-medium menu-item py-2">Profil</a>
                <a href="#program" class="text-gray-700 hover:text-blue-600 font-medium menu-item py-2">Program</a>
                <a href="#ppdb" class="text-gray-700 hover:text-blue-600 font-medium menu-item py-2">PPDB</a>
                <a href="#spp" class="text-gray-700 hover:text-blue-600 font-medium menu-item py-2">SPP Online</a>
                <a href="#marketplace" class="text-gray-700 hover:text-blue-600 font-medium menu-item py-2">Marketplace</a>
                <a href="#tabungan" class="text-gray-700 hover:text-blue-600 font-medium menu-item py-2">Tabungan</a>
                <a href="#absensi" class="text-gray-700 hover:text-blue-600 font-medium menu-item py-2">Absensi</a>
                <a href="#galeri" class="text-gray-700 hover:text-blue-600 font-medium menu-item py-2">Galeri</a>
                <a href="#kontak" class="text-gray-700 hover:text-blue-600 font-medium menu-item py-2">Kontak</a>
                
                <!-- Notification Bell -->
                <div class="notification-bell relative ml-4">
                    <button onclick="toggleNotifications()" class="relative p-2 text-gray-700 hover:text-blue-600">
                        <i class="fas fa-bell text-xl"></i>
                        <span class="notification-badge">3</span>
                    </button>
                    
                    <div id="notification-dropdown" class="notification-dropdown">
                        <div class="p-4 border-b border-gray-200">
                            <h4 class="font-semibold text-gray-800">Notifikasi</h4>
                            <span id="connection-status" class="connection-status connection-connected">
                                <i class="fas fa-circle text-xs mr-2"></i>Connected
                            </span>
                        </div>
                        
                        <div id="notification-list" class="max-h-96 overflow-y-auto">
                            <!-- Notifications will be loaded here -->
                        </div>
                        
                        <div class="p-4 border-t border-gray-200 text-center">
                            <button onclick="markAllAsRead()" class="text-sm text-blue-600 hover:text-blue-800">
                                Tandai semua sudah dibaca
                            </button>
                        </div>
                    </div>
                </div>
                
                <a href="#e-learning" class="btn-kemendikbud">
                    <i class="fas fa-graduation-cap mr-2"></i>E-Learning
                </a>
                <div id="user-menu" class="hidden flex items-center space-x-3 ml-4">
                    <div class="relative">
                        <img id="user-avatar" src="https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg" alt="User avatar" class="w-10 h-10 rounded-full object-cover border-2 border-white shadow">
                        <span class="notification-badge">3</span>
                    </div>
                    <div>
                        <span id="username" class="font-medium text-gray-800 block"></span>
                        <button onclick="logout()" class="text-red-500 hover:text-red-700 text-sm">Logout</button>
                    </div>
                </div>
            </div>
            
            <div class="flex items-center space-x-4 lg:hidden">
                <div class="notification-bell relative">
                    <button onclick="toggleNotifications()" class="relative p-2 text-gray-700 hover:text-blue-600">
                        <i class="fas fa-bell text-xl"></i>
                        <span class="notification-badge">3</span>
                    </button>
                </div>
                <button class="text-gray-700 hover:text-blue-600 transition-colors" id="mobile-menu-button">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
        
        <div class="lg:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-4 space-y-2 sm:px-3 bg-white border-t shadow-lg">
                <a href="#home" class="block px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-colors">Beranda</a>
                <a href="#profile" class="block px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-colors">Profil</a>
                <a href="#program" class="block px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-colors">Program</a>
                <a href="#ppdb" class="block px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-colors">PPDB</a>
                <a href="#spp" class="block px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-colors">SPP Online</a>
                <a href="#marketplace" class="block px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-colors">Marketplace</a>
                <a href="#tabungan" class="block px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-colors">Tabungan</a>
                <a href="#absensi" class="block px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-colors">Absensi</a>
                <a href="#galeri" class="block px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-colors">Galeri</a>
                <a href="#kontak" class="block px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-colors">Kontak</a>
                <a href="#e-learning" class="block px-4 py-3 rounded-lg text-base font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors">
                    <i class="fas fa-graduation-cap mr-2"></i>E-Learning
                </a>
                <div id="mobile-user-menu" class="hidden pt-4 border-t border-gray-200">
                    <div class="flex items-center px-4 py-3">
                        <img id="mobile-user-avatar" src="https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg" alt="User" class="w-10 h-10 rounded-full object-cover border-2 border-white shadow">
                        <div class="ml-3">
                            <span id="mobile-username" class="font-medium text-gray-800 block"></span>
                            <span class="text-sm text-gray-600" id="mobile-user-role"></span>
                        </div>
                    </div>
                    <button onclick="logout()" class="block w-full text-left px-4 py-3 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors">
                        <i class="fas fa-sign-out-alt mr-2"></i>Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Toast Notification -->
    <div id="toast-container"></div>

    <!-- Hero Section -->
    <section id="home" class="relative h-screen flex items-center justify-center text-white hero">
        <div class="hero-overlay absolute inset-0"></div>
        
        <div class="container mx-auto px-4 relative z-10 text-center">
            <div class="flex justify-center mb-8 floating-element">
                <div class="relative">
                    <img src="https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg" alt="Logo SMP Islam Ibadurrahman Temas" class="w-40 h-40 object-contain bg-white rounded-full p-4 shadow-2xl">
                    <div class="absolute -top-2 -right-2 w-12 h-12 bg-yellow-400 rounded-full flex items-center justify-center shadow-lg">
                        <i class="fas fa-star text-white text-xl"></i>
                    </div>
                </div>
            </div>
            <h1 class="text-4xl md:text-6xl font-bold mb-6 typewriter">SMP Islam Ibadurrahman Temas</h1>
            <p class="text-xl md:text-2xl mb-8 max-w-3xl mx-auto leading-relaxed">Mencetak kader-kader pemimpin ummat, Menjadi sumber pengetahuan Islam, Bahasa, Al-Qurn, dan Ilmu Pengetahuan Umum dengan tetap berjiwa Pesantren</p>
            
            <div class="flex flex-col sm:flex-row justify-center gap-4 mb-12">
                <a href="#program" class="btn-kemendikbud py-4 px-8 text-lg">
                    <i class="fas fa-book-open mr-2"></i>Program Kami
                </a>
                <a href="#ppdb" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-4 px-8 rounded-full transition duration-300 shadow-lg">
                    <i class="fas fa-user-plus mr-2"></i>Daftar PPDB
                </a>
                <a href="#e-learning" class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-4 px-8 rounded-full transition duration-300 shadow-lg">
                    <i class="fas fa-graduation-cap mr-2"></i>Platform E-Learning
                </a>
            </div>
            
            <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce">
                <a href="#profile" class="text-white hover:text-blue-200 transition-colors">
                    <i class="fas fa-chevron-down text-3xl"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Profile Section -->
    <section id="profile" class="py-20 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="section-title">Profil SMP Islam Ibadurrahman</h2>
                <p class="text-gray-600 max-w-2xl mx-auto mt-6 text-lg leading-relaxed">SMP Islam Ibadurrahman Temas merupakan lembaga pendidikan Islam yang berdiri sejak tahun 2017, berkomitmen untuk mencetak generasi yang menguasai ilmu agama dan ilmu umum secara seimbang.</p>
            </div>
            
            <div class="flex flex-col lg:flex-row items-center gap-12">
                <div class="lg:w-1/2">
                    <div class="relative">
                        <img src="https://i.ibb.co.com/9zT0Pfd/Whats-App-Image-2025-10-26-at-16-05-36.jpg" alt="SMP Islam Ibadurrahman Temas" class="rounded-2xl shadow-2xl w-full card-hover">
                        <div class="absolute -bottom-4 -right-4 bg-blue-600 text-white p-6 rounded-2xl shadow-lg">
                            <div class="text-3xl font-bold">2017</div>
                            <div class="text-sm">Tahun Berdiri</div>
                        </div>
                    </div>
                </div>
                
                <div class="lg:w-1/2">
                    <h3 class="text-3xl font-semibold text-gray-800 mb-6">Mengenal SMP Islam Ibadurrahman</h3>
                    
                    <div class="space-y-6 mb-8">
                        <div class="flex items-start bg-blue-50 p-4 rounded-xl">
                            <div class="flex-shrink-0 bg-blue-100 p-3 rounded-full">
                                <i class="fas fa-check text-blue-600 text-lg"></i>
                            </div>
                            <p class="ml-4 text-gray-700">Kurikulum terintegrasi antara pendidikan agama dan umum dengan pendekatan modern</p>
                        </div>
                        
                        <div class="flex items-start bg-green-50 p-4 rounded-xl">
                            <div class="flex-shrink-0 bg-green-100 p-3 rounded-full">
                                <i class="fas fa-check text-green-600 text-lg"></i>
                            </div>
                            <p class="ml-4 text-gray-700">Tenaga pengajar yang kompeten, berpengalaman, dan bersertifikasi</p>
                        </div>
                        
                        <div class="flex items-start bg-purple-50 p-4 rounded-xl">
                            <div class="flex-shrink-0 bg-purple-100 p-3 rounded-full">
                                <i class="fas fa-check text-purple-600 text-lg"></i>
                            </div>
                            <p class="ml-4 text-gray-700">Fasilitas lengkap dan modern untuk menunjang pembelajaran optimal</p>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-2xl mb-8 shadow-lg">
                        <h4 class="font-semibold text-xl mb-3">Visi Sekolah</h4>
                        <p class="text-blue-100 leading-relaxed">"Menjadi lembaga pendidikan unggulan yang mencetak generasi Qur'ani berakhlak mulia, berwawasan global, dan berkontribusi bagi umat"</p>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-8">
                        <div class="bg-gray-50 p-4 rounded-xl text-center">
                            <div class="text-3xl font-bold text-blue-600 mb-2">500+</div>
                            <div class="text-gray-600">Siswa Aktif</div>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-xl text-center">
                            <div class="text-3xl font-bold text-blue-600 mb-2">50+</div>
                            <div class="text-gray-600">Tenaga Pengajar</div>
                        </div>
                    </div>
                    
                    <a href="#" class="inline-flex items-center text-blue-600 font-semibold hover:text-blue-800 group">
                        <span class="mr-2">Selengkapnya Tentang Kami</span>
                        <i class="fas fa-arrow-right group-hover:translate-x-2 transition-transform"></i>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Program Section -->
    <section id="program" class="py-20 bg-gray-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="section-title">Program Pembelajaran</h2>
                <p class="text-gray-600 max-w-2xl mx-auto mt-6 text-lg">Berbagai program unggulan yang disediakan untuk mencetak santri yang berkompeten di berbagai bidang</p>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="card-kemendikbud">
                    <div class="h-56 overflow-hidden relative">
                        <img src="https://i.ibb.co.com/j9wdYj21/Whats-App-Image-2025-10-26-at-16-05-34.jpg" alt="Program Qirat Sabh" class="w-full h-full object-cover">
                        <div class="absolute top-4 left-4 bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium">
                            <i class="fas fa-quran mr-1"></i>Agama
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                                <i class="fas fa-quran text-blue-600 text-xl"></i>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-800">Qirat Sabh</h3>
                        </div>
                        <p class="text-gray-600 mb-4 leading-relaxed">Program membaca Al-Quran dengan tartil, memperbaiki makhraj dan tajwid serta menumbuhkan kecintaan terhadap Al-Qurn sejak dini.</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-gray-500 text-sm">
                                <i class="fas fa-clock mr-1"></i>
                                <span>Setiap Pagi</span>
                            </div>
                            <a href="#" class="text-blue-600 font-medium hover:text-blue-800 flex items-center group">
                                <span class="mr-2">Detail</span>
                                <i class="fas fa-arrow-right group-hover:translate-x-2 transition-transform"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="card-kemendikbud">
                    <div class="h-56 overflow-hidden relative">
                        <img src="https://i.ibb.co.com/k26ypcmQ/Whats-App-Image-2025-10-29-at-22-43-14.jpg" alt="Program Bahasa Arab dan Inggris" class="w-full h-full object-cover">
                        <div class="absolute top-4 left-4 bg-green-600 text-white px-3 py-1 rounded-full text-sm font-medium">
                            <i class="fas fa-language mr-1"></i>Bahasa
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-4">
                                <i class="fas fa-language text-green-600 text-xl"></i>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-800">Bahasa Arab & Inggris</h3>
                        </div>
                        <p class="text-gray-600 mb-4 leading-relaxed">Program unggulan untuk memperkuat kompetensi bahasa internasional dan keislaman siswa melalui pendekatan intensif dan praktik harian.</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-gray-500 text-sm">
                                <i class="fas fa-users mr-1"></i>
                                <span>Small Class</span>
                            </div>
                            <a href="#" class="text-blue-600 font-medium hover:text-blue-800 flex items-center group">
                                <span class="mr-2">Detail</span>
                                <i class="fas fa-arrow-right group-hover:translate-x-2 transition-transform"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="card-kemendikbud">
                    <div class="h-56 overflow-hidden relative">
                        <img src="https://i.ibb.co.com/F2tTFgT/Whats-App-Image-2025-10-29-at-22-43-14-1.jpg" alt="Pendidikan Formal" class="w-full h-full object-cover">
                        <div class="absolute top-4 left-4 bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-medium">
                            <i class="fas fa-graduation-cap mr-1"></i>Formal
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mr-4">
                                <i class="fas fa-graduation-cap text-purple-600 text-xl"></i>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-800">Pendidikan Formal</h3>
                        </div>
                        <p class="text-gray-600 mb-4 leading-relaxed">Kurikulum nasional yang dipadukan dengan nilai-nilai Islami untuk pendidikan yang holistik dan berkarakter sesuai standar Kemendikbud.</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-gray-500 text-sm">
                                <i class="fas fa-certificate mr-1"></i>
                                <span>Berkurikulum</span>
                            </div>
                            <a href="#" class="text-blue-600 font-medium hover:text-blue-800 flex items-center group">
                                <span class="mr-2">Detail</span>
                                <i class="fas fa-arrow-right group-hover:translate-x-2 transition-transform"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-12">
                <a href="#" class="btn-kemendikbud text-lg py-4 px-10 inline-flex items-center">
                    <i class="fas fa-list mr-2"></i>Lihat Semua Program
                </a>
            </div>
        </div>
    </section>

    <!-- PPDB Section -->
    <section id="ppdb" class="py-20 bg-gradient-to-r from-blue-50 to-green-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="section-title">Penerimaan Peserta Didik Baru</h2>
                <p class="text-gray-600 max-w-2xl mx-auto mt-6 text-lg">Daftarkan putra-putri Anda untuk bergabung dengan keluarga besar SMP Islam Ibadurrahman Temas tahun ajaran 2024/2025</p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-8 mb-12">
                <div class="bg-white rounded-2xl p-8 shadow-lg text-center">
                    <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-calendar-alt text-blue-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Periode Pendaftaran</h3>
                    <p class="text-gray-600 mb-4">1 Januari - 30 Juni 2024</p>
                    <div class="text-4xl font-bold text-blue-600 ppdb-counter" id="ppdb-days-left">180</div>
                    <p class="text-gray-500 text-sm">Hari Tersisa</p>
                </div>
                
                <div class="bg-white rounded-2xl p-8 shadow-lg text-center">
                    <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-user-graduate text-green-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Kuota Penerimaan</h3>
                    <p class="text-gray-600 mb-4">200 Siswa/i</p>
                    <div class="text-4xl font-bold text-green-600 ppdb-counter" id="ppdb-quota-left">75</div>
                    <p class="text-gray-500 text-sm">Kuota Tersisa</p>
                </div>
                
                <div class="bg-white rounded-2xl p-8 shadow-lg text-center">
                    <div class="w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-file-alt text-purple-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Pendaftar</h3>
                    <p class="text-gray-600 mb-4">Total Pendaftar</p>
                    <div class="text-4xl font-bold text-purple-600 ppdb-counter" id="ppdb-registered">125</div>
                    <p class="text-gray-500 text-sm">Pendaftar</p>
                </div>
            </div>
            
            <div class="glass-card p-8 mb-12">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6">Persyaratan Pendaftaran</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-blue-50 p-6 rounded-xl">
                        <h4 class="font-semibold text-blue-700 mb-4">Persyaratan Umum</h4>
                        <ul class="space-y-3">
                            <li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-3"></i><span>Lulus SD/MI atau sederajat</span></li>
                            <li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-3"></i><span>Usia maksimal 15 tahun per 1 Juli 2024</span></li>
                            <li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-3"></i><span>Memiliki akhlak yang baik</span></li>
                            <li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-3"></i><span>Sehat jasmani dan rohani</span></li>
                        </ul>
                    </div>
                    
                    <div class="bg-green-50 p-6 rounded-xl">
                        <h4 class="font-semibold text-green-700 mb-4">Berkas yang Diperlukan</h4>
                        <ul class="space-y-3">
                            <li class="flex items-start"><i class="fas fa-file text-blue-500 mt-1 mr-3"></i><span>Fotokopi Akta Kelahiran (3 lembar)</span></li>
                            <li class="flex items-start"><i class="fas fa-file text-blue-500 mt-1 mr-3"></i><span>Fotokopi KK (3 lembar)</span></li>
                            <li class="flex items-start"><i class="fas fa-file text-blue-500 mt-1 mr-3"></i><span>Fotokopi Ijazah SD/MI (3 lembar)</span></li>
                            <li class="flex items-start"><i class="fas fa-file text-blue-500 mt-1 mr-3"></i><span>Pas foto 3x4 (4 lembar)</span></li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="glass-card p-8">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6">Formulir Pendaftaran Online</h3>
                <form id="ppdb-form" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div><label for="ppdb-nama" class="form-label">Nama Lengkap Calon Siswa</label><input type="text" id="ppdb-nama" class="form-input" placeholder="Masukkan nama lengkap" required></div>
                        <div><label for="ppdb-tempat-lahir" class="form-label">Tempat, Tanggal Lahir</label><div class="flex gap-3"><input type="text" id="ppdb-tempat-lahir" class="form-input flex-1" placeholder="Tempat lahir" required><input type="date" id="ppdb-tanggal-lahir" class="form-input flex-1" required></div></div>
                        <div><label for="ppdb-jenis-kelamin" class="form-label">Jenis Kelamin</label><select id="ppdb-jenis-kelamin" class="form-input" required><option value="">Pilih jenis kelamin</option><option value="L">Laki-laki</option><option value="P">Perempuan</option></select></div>
                        <div><label for="ppdb-asal-sekolah" class="form-label">Asal Sekolah</label><input type="text" id="ppdb-asal-sekolah" class="form-input" placeholder="Nama SD/MI asal" required></div>
                        <div><label for="ppdb-alamat" class="form-label">Alamat Lengkap</label><textarea id="ppdb-alamat" rows="3" class="form-input" placeholder="Alamat lengkap calon siswa" required></textarea></div>
                        <div><label for="ppdb-no-hp" class="form-label">No. HP Orang Tua</label><input type="tel" id="ppdb-no-hp" class="form-input" placeholder="08xxxxxxxxxx" required></div>
                        <div><label for="ppdb-email" class="form-label">Email Orang Tua</label><input type="email" id="ppdb-email" class="form-input" placeholder="email@example.com" required></div>
                        <div><label for="ppdb-jalur" class="form-label">Jalur Pendaftaran</label><select id="ppdb-jalur" class="form-input" required><option value="">Pilih jalur pendaftaran</option><option value="prestasi">Jalur Prestasi</option><option value="reguler">Jalur Reguler</option><option value="afirmasi">Jalur Afirmasi</option></select></div>
                    </div>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4">
                        <div class="flex items-start"><i class="fas fa-exclamation-triangle text-yellow-600 mt-1 mr-3"></i><div><p class="text-yellow-800 font-medium">Biaya Pendaftaran: Rp 250.000</p><p class="text-yellow-700 text-sm mt-1">Biaya pendaftaran dapat dibayarkan melalui transfer bank atau langsung ke sekolah</p></div></div>
                    </div>
                    
                    <div class="flex items-center">
                        <input type="checkbox" id="ppdb-agreement" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" required>
                        <label for="ppdb-agreement" class="ml-3 text-gray-700">Saya menyetujui <a href="#" class="text-blue-600 hover:text-blue-800">syarat dan ketentuan</a></label>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <div><p class="text-gray-600 text-sm">No. Pendaftaran:</p><p class="text-lg font-bold text-blue-600" id="ppdb-registration-number">PPDB-2024-0001</p></div>
                        <button type="submit" class="interactive-btn bg-gradient-to-r from-green-500 to-green-600"><i class="fas fa-paper-plane mr-2"></i>Daftar Sekarang</button>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- SPP Online Section -->
    <section id="spp" class="py-20 bg-gradient-to-r from-green-50 to-blue-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="section-title">Pembayaran SPP Online</h2>
                <p class="text-gray-600 max-w-2xl mx-auto mt-6 text-lg">Bayar SPP dengan mudah dan cepat melalui sistem pembayaran online yang terintegrasi</p>
            </div>
            
            <div class="grid lg:grid-cols-2 gap-10 mb-12">
                <div class="glass-card p-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-6">Cek Tagihan SPP</h3>
                    <form id="spp-check-form" class="space-y-6 mb-8">
                        <div><label for="spp-nis" class="form-label">Nomor Induk Siswa (NIS)</label><div class="relative"><i class="fas fa-id-card absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i><input type="text" id="spp-nis" class="form-input pl-12" placeholder="Masukkan NIS siswa"></div></div>
                        <div><label for="spp-bulan" class="form-label">Bulan Tagihan</label><select id="spp-bulan" class="form-input"><option value="">Pilih bulan</option><option value="01">Januari</option><option value="02">Februari</option><option value="03">Maret</option><option value="04">April</option><option value="05">Mei</option><option value="06">Juni</option><option value="07">Juli</option><option value="08">Agustus</option><option value="09">September</option><option value="10">Oktober</option><option value="11">November</option><option value="12">Desember</option></select></div>
                        <button type="submit" class="w-full interactive-btn bg-gradient-to-r from-blue-500 to-blue-600"><i class="fas fa-search mr-2"></i>Cek Tagihan</button>
                    </form>
                    
                    <div id="spp-result" class="hidden space-y-6">
                        <div class="bg-white border border-gray-200 rounded-xl p-6">
                            <div class="flex justify-between items-center mb-4"><h4 class="text-lg font-semibold text-gray-800">Detail Tagihan</h4><span class="payment-badge paid">LUNAS</span></div>
                            <div class="space-y-3">
                                <div class="flex justify-between"><span class="text-gray-600">Nama Siswa</span><span class="font-medium" id="spp-nama-siswa">-</span></div>
                                <div class="flex justify-between"><span class="text-gray-600">Kelas</span><span class="font-medium" id="spp-kelas">-</span></div>
                                <div class="flex justify-between"><span class="text-gray-600">Bulan Tagihan</span><span class="font-medium" id="spp-bulan-tagihan">-</span></div>
                                <div class="flex justify-between"><span class="text-gray-600">Jatuh Tempo</span><span class="font-medium" id="spp-jatuh-tempo">-</span></div>
                                <div class="flex justify-between border-t border-gray-200 pt-3"><span class="text-gray-600 font-semibold">Total Tagihan</span><span class="text-xl font-bold text-green-600" id="spp-total">Rp 0</span></div>
                            </div>
                        </div>
                        <button id="spp-pay-button" class="w-full interactive-btn bg-gradient-to-r from-green-500 to-green-600"><i class="fas fa-credit-card mr-2"></i>Bayar Sekarang</button>
                    </div>
                </div>
                
                <div class="glass-card p-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-6">Riwayat Pembayaran</h3>
                    <div class="overflow-x-auto">
                        <table class="data-table">
                            <thead><tr><th>Bulan</th><th>Jumlah</th><th>Status</th><th>Tanggal Bayar</th></tr></thead>
                            <tbody id="spp-history"></tbody>
                        </table>
                    </div>
                    
                    <div class="mt-8">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">Metode Pembayaran</h4>
                        <div class="grid grid-cols-4 gap-4">
                            <div class="bg-gray-50 p-4 rounded-xl text-center"><i class="fas fa-university text-blue-600 text-2xl mb-2"></i><p class="text-sm font-medium">Transfer Bank</p></div>
                            <div class="bg-gray-50 p-4 rounded-xl text-center"><i class="fab fa-gopay text-green-600 text-2xl mb-2"></i><p class="text-sm font-medium">Gopay</p></div>
                            <div class="bg-gray-50 p-4 rounded-xl text-center"><i class="fab fa-ovo text-purple-600 text-2xl mb-2"></i><p class="text-sm font-medium">OVO</p></div>
                            <div class="bg-gray-50 p-4 rounded-xl text-center"><i class="fab fa-dana text-blue-500 text-2xl mb-2"></i><p class="text-sm font-medium">DANA</p></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="glass-card p-8">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6">Informasi Biaya Pendidikan</h3>
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead><tr><th>Komponen Biaya</th><th>Kelas 7</th><th>Kelas 8</th><th>Kelas 9</th><th>Keterangan</th></tr></thead>
                        <tbody>
                            <tr><td class="font-medium">SPP Bulanan</td><td>Rp 350.000</td><td>Rp 350.000</td><td>Rp 350.000</td><td>Dibayar setiap bulan</td></tr>
                            <tr><td class="font-medium">Uang Gedung</td><td>Rp 2.500.000</td><td>Rp 2.000.000</td><td>Rp 1.500.000</td><td>Sekali bayar saat masuk</td></tr>
                            <tr><td class="font-medium">Uang Seragam</td><td>Rp 1.200.000</td><td>Rp 800.000</td><td>Rp 600.000</td><td>Sekali bayar per tahun</td></tr>
                            <tr><td class="font-medium">Uang Kegiatan</td><td>Rp 500.000</td><td>Rp 500.000</td><td>Rp 500.000</td><td>Per semester</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 mt-8">
                    <div class="flex items-start"><i class="fas fa-info-circle text-blue-600 mt-1 mr-3"></i><div><h4 class="font-semibold text-blue-800 mb-2">Informasi Penting</h4><ul class="text-blue-700 space-y-2"><li> Pembayaran SPP paling lambat tanggal 10 setiap bulannya</li><li> Keterlambatan pembayaran dikenakan denda Rp 25.000 per minggu</li><li> Pembayaran dapat dilakukan via transfer ke rekening BNI 1234567890</li><li> Konfirmasi pembayaran via WhatsApp ke 0812-3456-7890</li></ul></div></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Marketplace Section -->
    <section id="marketplace" class="py-20 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="section-title">Marketplace Pondok</h2>
                <p class="text-gray-600 max-w-2xl mx-auto mt-6 text-lg">Temukan kebutuhan sekolah, seragam, buku, dan produk lainnya dengan harga khusus</p>
            </div>
            
            <div class="flex flex-wrap justify-center gap-4 mb-12">
                <button class="px-6 py-3 rounded-full bg-gradient-to-r from-purple-500 to-purple-600 text-white font-medium" onclick="filterProducts('all')">Semua Produk</button>
                <button class="px-6 py-3 rounded-full bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium" onclick="filterProducts('seragam')">Seragam</button>
                <button class="px-6 py-3 rounded-full bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium" onclick="filterProducts('buku')">Buku & Alat Tulis</button>
                <button class="px-6 py-3 rounded-full bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium" onclick="filterProducts('makanan')">Makanan & Minuman</button>
                <button class="px-6 py-3 rounded-full bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium" onclick="filterProducts('lainnya')">Lainnya</button>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12" id="marketplace-products"></div>
            
            <div class="glass-card p-8">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6">Keranjang Belanja</h3>
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead><tr><th>Produk</th><th>Harga</th><th>Jumlah</th><th>Subtotal</th><th>Aksi</th></tr></thead>
                        <tbody id="shopping-cart"></tbody>
                        <tfoot><tr><td colspan="3" class="text-right font-semibold">Total Belanja:</td><td class="text-xl font-bold text-purple-600" id="cart-total">Rp 0</td><td></td></tr></tfoot>
                    </table>
                </div>
                
                <div class="flex justify-between items-center mt-8">
                    <div><p class="text-gray-600 text-sm">Total items: <span class="font-medium" id="cart-items-count">0</span></p><p class="text-gray-600 text-sm">Estimasi pengiriman: 2-3 hari kerja</p></div>
                    <div class="flex gap-4">
                        <button onclick="clearCart()" class="px-6 py-3 border-2 border-red-500 text-red-500 hover:bg-red-50 rounded-full font-medium transition-colors"><i class="fas fa-trash-alt mr-2"></i>Kosongkan Keranjang</button>
                        <button onclick="checkout()" class="interactive-btn bg-gradient-to-r from-purple-500 to-purple-600"><i class="fas fa-shopping-cart mr-2"></i>Checkout</button>
                    </div>
                </div>
            </div>
            
            <div class="mt-12 grid md:grid-cols-3 gap-8">
                <div class="bg-gradient-to-r from-blue-50 to-blue-100 p-8 rounded-2xl text-center"><i class="fas fa-shipping-fast text-blue-600 text-4xl mb-6"></i><h4 class="text-xl font-semibold text-gray-800 mb-3">Gratis Ongkir</h4><p class="text-gray-600">Gratis ongkos kirim untuk pembelian minimal Rp 200.000 di area Kota Batu</p></div>
                <div class="bg-gradient-to-r from-green-50 to-green-100 p-8 rounded-2xl text-center"><i class="fas fa-hand-holding-usd text-green-600 text-4xl mb-6"></i><h4 class="text-xl font-semibold text-gray-800 mb-3">Harga Khusus</h4><p class="text-gray-600">Harga khusus untuk siswa, orang tua siswa, dan alumni</p></div>
                <div class="bg-gradient-to-r from-purple-50 to-purple-100 p-8 rounded-2xl text-center"><i class="fas fa-headset text-purple-600 text-4xl mb-6"></i><h4 class="text-xl font-semibold text-gray-800 mb-3">Bantuan 24/7</h4><p class="text-gray-600">Tim support siap membantu Anda 24 jam melalui WhatsApp dan telepon</p></div>
            </div>
        </div>
    </section>

    <!-- Tabungan Section -->
    <section id="tabungan" class="py-20 bg-gradient-to-r from-yellow-50 to-orange-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="section-title">Tabungan Santri</h2>
                <p class="text-gray-600 max-w-2xl mx-auto mt-6 text-lg">Ajarkan menabung sejak dini dengan sistem tabungan digital yang aman dan terpercaya</p>
            </div>
            
            <div class="grid lg:grid-cols-3 gap-8 mb-12">
                <div class="glass-card p-8 text-center"><div class="w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-6"><i class="fas fa-piggy-bank text-yellow-600 text-3xl"></i></div><h3 class="text-xl font-semibold text-gray-800 mb-4">Tabungan Reguler</h3><p class="text-gray-600 mb-4">Tabungan harian dengan bunga 0.5% per bulan. Minimal setoran Rp 10.000</p><div class="text-3xl font-bold text-yellow-600">0.5%</div><p class="text-gray-500 text-sm">Bunga per bulan</p></div>
                <div class="glass-card p-8 text-center"><div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6"><i class="fas fa-graduation-cap text-green-600 text-3xl"></i></div><h3 class="text-xl font-semibold text-gray-800 mb-4">Tabungan Pendidikan</h3><p class="text-gray-600 mb-4">Persiapan biaya pendidikan dengan bunga 1% per bulan. Minimal setoran Rp 50.000</p><div class="text-3xl font-bold text-green-600">1%</div><p class="text-gray-500 text-sm">Bunga per bulan</p></div>
                <div class="glass-card p-8 text-center"><div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6"><i class="fas fa-hands-helping text-blue-600 text-3xl"></i></div><h3 class="text-xl font-semibold text-gray-800 mb-4">Tabungan Qurban</h3><p class="text-gray-600 mb-4">Persiapan ibadah qurban dengan sistem setoran rutin. Fleksibel dan syar'i</p><div class="text-3xl font-bold text-blue-600">Bebas Admin</div><p class="text-gray-500 text-sm">Tidak ada biaya administrasi</p></div>
            </div>
            
            <div class="grid lg:grid-cols-2 gap-10">
                <div class="glass-card p-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-6">Cek Saldo & Transaksi</h3>
                    <form id="tabungan-check-form" class="space-y-6 mb-8">
                        <div><label for="tabungan-nis" class="form-label">Nomor Induk Siswa (NIS)</label><div class="relative"><i class="fas fa-id-card absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i><input type="text" id="tabungan-nis" class="form-input pl-12" placeholder="Masukkan NIS siswa"></div></div>
                        <div><label for="tabungan-pin" class="form-label">PIN Tabungan (6 digit)</label><div class="relative"><i class="fas fa-lock absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i><input type="password" id="tabungan-pin" class="form-input pl-12" placeholder="Masukkan PIN" maxlength="6"></div></div>
                        <button type="submit" class="w-full interactive-btn bg-gradient-to-r from-yellow-500 to-yellow-600"><i class="fas fa-search mr-2"></i>Cek Tabungan</button>
                    </form>
                    
                    <div id="tabungan-result" class="hidden space-y-6">
                        <div class="bg-white border border-gray-200 rounded-xl p-6">
                            <div class="flex justify-between items-center mb-4"><h4 class="text-lg font-semibold text-gray-800">Informasi Tabungan</h4><span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">AKTIF</span></div>
                            <div class="space-y-3">
                                <div class="flex justify-between"><span class="text-gray-600">Nama Pemilik</span><span class="font-medium" id="tabungan-nama">-</span></div>
                                <div class="flex justify-between"><span class="text-gray-600">No. Rekening</span><span class="font-medium" id="tabungan-rekening">-</span></div>
                                <div class="flex justify-between"><span class="text-gray-600">Jenis Tabungan</span><span class="font-medium" id="tabungan-jenis">-</span></div>
                                <div class="flex justify-between border-t border-gray-200 pt-3"><span class="text-gray-600 font-semibold">Saldo Saat Ini</span><span class="text-2xl font-bold text-green-600" id="tabungan-saldo">Rp 0</span></div>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="showSetorModal()" class="interactive-btn bg-gradient-to-r from-green-500 to-green-600"><i class="fas fa-plus mr-2"></i>Setor</button>
                            <button onclick="showTarikModal()" class="interactive-btn bg-gradient-to-r from-blue-500 to-blue-600"><i class="fas fa-minus mr-2"></i>Tarik</button>
                        </div>
                    </div>
                </div>
                
                <div class="glass-card p-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-6">Riwayat Transaksi</h3>
                    <div class="overflow-x-auto mb-6">
                        <table class="data-table">
                            <thead><tr><th>Tanggal</th><th>Jenis</th><th>Jumlah</th><th>Saldo</th></tr></thead>
                            <tbody id="tabungan-history"></tbody>
                        </table>
                    </div>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-6">
                        <div class="flex items-start"><i class="fas fa-lightbulb text-yellow-600 text-xl mt-1 mr-3"></i><div><h4 class="font-semibold text-yellow-800 mb-2">Tips Menabung</h4><ul class="text-yellow-700 space-y-2 text-sm"><li> Sisihkan 10% dari uang saku untuk ditabung</li><li> Buat target tabungan untuk tujuan spesifik</li><li> Hindari menarik tabungan untuk kebutuhan konsumtif</li><li> Manfaatkan bunga tabungan untuk mempercepat mencapai target</li></ul></div></div>
                    </div>
                </div>
            </div>
            
            <div class="mt-12 glass-card p-8">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6">Buka Rekening Tabungan Baru</h3>
                <form id="tabungan-new-form" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div><label for="new-tabungan-nis" class="form-label">NIS Siswa</label><input type="text" id="new-tabungan-nis" class="form-input" placeholder="Masukkan NIS" required></div>
                        <div><label for="new-tabungan-jenis" class="form-label">Jenis Tabungan</label><select id="new-tabungan-jenis" class="form-input" required><option value="">Pilih jenis tabungan</option><option value="reguler">Tabungan Reguler</option><option value="pendidikan">Tabungan Pendidikan</option><option value="qurban">Tabungan Qurban</option></select></div>
                        <div><label for="new-tabungan-setoran" class="form-label">Setoran Awal</label><input type="number" id="new-tabungan-setoran" class="form-input" placeholder="Minimal Rp 10.000" min="10000" required></div>
                        <div><label for="new-tabungan-pin" class="form-label">Buat PIN (6 digit)</label><input type="password" id="new-tabungan-pin" class="form-input" placeholder="Masukkan 6 digit PIN" maxlength="6" required></div>
                    </div>
                    
                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-4">
                        <div class="flex items-start"><i class="fas fa-info-circle text-blue-600 mt-1 mr-3"></i><div><p class="text-blue-800 font-medium">Informasi Penting</p><p class="text-blue-700 text-sm mt-1"> Tabungan dapat dibuka oleh siswa dengan persetujuan orang tua/wali</p><p class="text-blue-700 text-sm"> Setiap rekening dilindungi asuransi hingga Rp 2.000.000</p><p class="text-blue-700 text-sm"> Laporan tabungan akan dikirimkan ke orang tua setiap bulan</p></div></div>
                    </div>
                    
                    <button type="submit" class="w-full interactive-btn bg-gradient-to-r from-yellow-500 to-yellow-600"><i class="fas fa-check-circle mr-2"></i>Buka Rekening Tabungan</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Absensi & Kehadiran Section -->
    <section id="absensi" class="py-20 bg-gradient-to-r from-indigo-50 to-purple-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="section-title">Sistem Absensi Digital</h2>
                <p class="text-gray-600 max-w-2xl mx-auto mt-6 text-lg">Sistem presensi modern dengan QR Code dan notifikasi real-time kepada orang tua</p>
            </div>

            <div class="grid lg:grid-cols-3 gap-8 mb-12">
                <div class="absensi-card glass-card p-8">
                    <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-qrcode text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 text-center">QR Code Absensi</h3>
                    <p class="text-gray-600 mb-6 text-center">Absensi cepat dengan scan QR Code yang berbeda setiap hari</p>
                    <button onclick="showQRScanner()" class="w-full interactive-btn bg-gradient-to-r from-blue-500 to-blue-600">
                        <i class="fas fa-camera mr-2"></i>Buka QR Scanner
                    </button>
                </div>

                <div class="absensi-card glass-card p-8">
                    <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-green-600 rounded-2xl flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-chart-line text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 text-center">Laporan Kehadiran</h3>
                    <p class="text-gray-600 mb-6 text-center">Monitoring kehadiran siswa secara real-time dengan statistik lengkap</p>
                    <button onclick="showAttendanceReport()" class="w-full interactive-btn bg-gradient-to-r from-green-500 to-green-600">
                        <i class="fas fa-file-alt mr-2"></i>Lihat Laporan
                    </button>
                </div>

                <div class="absensi-card glass-card p-8">
                    <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-bell text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 text-center">Notifikasi Orang Tua</h3>
                    <p class="text-gray-600 mb-6 text-center">Orang tua menerima notifikasi real-time saat siswa absen atau terlambat</p>
                    <button onclick="showNotificationSettings()" class="w-full interactive-btn bg-gradient-to-r from-purple-500 to-purple-600">
                        <i class="fas fa-cog mr-2"></i>Pengaturan
                    </button>
                </div>
            </div>

            <!-- Attendance Report -->
            <div class="glass-card p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-semibold text-gray-800">Laporan Kehadiran Bulan Ini</h3>
                    <div class="flex items-center">
                        <select id="attendance-filter" class="form-input w-auto mr-4" onchange="filterAttendance()">
                            <option value="all">Semua Kelas</option>
                            <option value="7A">Kelas 7A</option>
                            <option value="7B">Kelas 7B</option>
                            <option value="8A">Kelas 8A</option>
                            <option value="9A">Kelas 9A</option>
                        </select>
                        <button onclick="exportAttendanceReport()" class="interactive-btn bg-gradient-to-r from-green-500 to-green-600">
                            <i class="fas fa-download mr-2"></i>Export
                        </button>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>NIS</th>
                                <th>Nama Siswa</th>
                                <th>Kelas</th>
                                <th>Hadir</th>
                                <th>Terlambat</th>
                                <th>Tidak Hadir</th>
                                <th>Persentase</th>
                                <th>Status Hari Ini</th>
                            </tr>
                        </thead>
                        <tbody id="attendance-table">
                            <!-- Data akan di-load via JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-8 grid md:grid-cols-4 gap-6">
                    <div class="stat-card">
                        <div class="stat-icon bg-green-100 text-green-600">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <div class="stat-value" id="total-present">0</div>
                        <div class="stat-label">Hadir Hari Ini</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon bg-yellow-100 text-yellow-600">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-value" id="total-late">0</div>
                        <div class="stat-label">Terlambat</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon bg-red-100 text-red-600">
                            <i class="fas fa-user-times"></i>
                        </div>
                        <div class="stat-value" id="total-absent">0</div>
                        <div class="stat-label">Tidak Hadir</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon bg-blue-100 text-blue-600">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div class="stat-value" id="attendance-rate">0%</div>
                        <div class="stat-label">Rata-rata Kehadiran</div>
                    </div>
                </div>
            </div>

            <!-- Notification Settings -->
            <div class="glass-card p-8 mt-8">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6">Pengaturan Notifikasi Orang Tua</h3>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">Jenis Notifikasi</h4>
                        
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-800">Ketidakhadiran Siswa</p>
                                    <p class="text-sm text-gray-600">Kirim notifikasi saat siswa tidak masuk</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notif-absence" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-800">Keterlambatan</p>
                                    <p class="text-sm text-gray-600">Kirim notifikasi jika siswa terlambat</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notif-late" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-800">Laporan Mingguan</p>
                                    <p class="text-sm text-gray-600">Kirim laporan kehadiran mingguan</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notif-weekly" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="space-y-6">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">Metode Pengiriman</h4>
                        
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-800">WhatsApp</p>
                                    <p class="text-sm text-gray-600">Kirim via WhatsApp ke orang tua</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="method-whatsapp" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-800">Email</p>
                                    <p class="text-sm text-gray-600">Kirim via email orang tua</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="method-email" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-800">SMS</p>
                                    <p class="text-sm text-gray-600">Kirim via SMS (jika tidak ada WhatsApp)</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="method-sms">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8">
                    <button onclick="saveNotificationSettings()" class="w-full interactive-btn bg-gradient-to-r from-purple-500 to-purple-600">
                        <i class="fas fa-save mr-2"></i>Simpan Pengaturan
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Galeri Section -->
    <section id="galeri" class="py-20 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="section-title">Galeri Kegiatan</h2>
                <p class="text-gray-600 max-w-2xl mx-auto mt-6 text-lg">Momen-momen berharga dalam proses pembelajaran di SMP Islam Ibadurrahman Temas</p>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                <div class="group relative overflow-hidden rounded-2xl shadow-lg"><img src="https://i.ibb.co.com/14X9TKH/Whats-App-Image-2025-10-26-at-16-05-33.jpg" alt="Kegiatan pembelajaran" class="w-full h-64 object-cover group-hover:scale-110 transition duration-500"><div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4"><p class="text-white font-medium">Kegiatan Pembelajaran</p></div></div>
                <div class="group relative overflow-hidden rounded-2xl shadow-lg"><img src="https://i.ibb.co.com/TDrkjyrJ/Whats-App-Image-2025-10-26-at-16-05-34-1.jpg" alt="Kegiatan ekstrakurikuler" class="w-full h-64 object-cover group-hover:scale-110 transition duration-500"><div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4"><p class="text-white font-medium">Ekstrakurikuler</p></div></div>
                <div class="group relative overflow-hidden rounded-2xl shadow-lg"><img src="https://i.ibb.co.com/TBCxVsS3/Whats-App-Image-2025-10-26-at-16-05-34-2.jpg" alt="Proses belajar mengajar" class="w-full h-64 object-cover group-hover:scale-110 transition duration-500"><div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4"><p class="text-white font-medium">Diskusi Kelompok</p></div></div>
                <div class="group relative overflow-hidden rounded-2xl shadow-lg"><img src="https://i.ibb.co.com/fVZ7Wrj2/Whats-App-Image-2025-10-26-at-16-05-36-1.jpg" alt="Aktivitas santri" class="w-full h-64 object-cover group-hover:scale-110 transition duration-500"><div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4"><p class="text-white font-medium">Aktivitas Santri</p></div></div>
                <div class="group relative overflow-hidden rounded-2xl shadow-lg"><img src="https://i.ibb.co.com/9zT0Pfd/Whats-App-Image-2025-10-26-at-16-05-36.jpg" alt="Kegiatan bersama" class="w-full h-64 object-cover group-hover:scale-110 transition duration-500"><div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4"><p class="text-white font-medium">Kegiatan Bersama</p></div></div>
                <div class="group relative overflow-hidden rounded-2xl shadow-lg"><img src="https://i.ibb.co.com/14X9TKH/Whats-App-Image-2025-10-26-at-16-05-33.jpg" alt="Suasana pembelajaran" class="w-full h-64 object-cover group-hover:scale-110 transition duration-500"><div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4"><p class="text-white font-medium">Suasana Kelas</p></div></div>
                <div class="group relative overflow-hidden rounded-2xl shadow-lg"><img src="https://i.ibb.co.com/TDrkjyrJ/Whats-App-Image-2025-10-26-at-16-05-34-1.jpg" alt="Interaksi guru dan santri" class="w-full h-64 object-cover group-hover:scale-110 transition duration-500"><div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4"><p class="text-white font-medium">Guru & Santri</p></div></div>
                <div class="group relative overflow-hidden rounded-2xl shadow-lg"><img src="https://i.ibb.co.com/TBCxVsS3/Whats-App-Image-2025-10-26-at-16-05-34-2.jpg" alt="Kegiatan kelompok" class="w-full h-64 object-cover group-hover:scale-110 transition duration-500"><div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4"><p class="text-white font-medium">Presentasi</p></div></div>
            </div>
            
            <div class="text-center mt-12">
                <a href="#" class="border-2 border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white font-semibold py-4 px-10 rounded-full transition duration-300 inline-flex items-center">
                    <i class="fas fa-images mr-2"></i>Lihat Lebih Banyak
                </a>
            </div>
        </div>
    </section>

    <!-- Kontak Section -->
    <section id="kontak" class="py-20 bg-gray-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="section-title">Hubungi Kami</h2>
                <p class="text-gray-600 max-w-2xl mx-auto mt-6 text-lg">Silahkan menghubungi kami untuk informasi lebih lanjut tentang pendaftaran dan program</p>
            </div>
            
            <div class="flex flex-col lg:flex-row gap-10">
                <div class="lg:w-1/2">
                    <div class="glass-card p-8">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-6">Kirim Pesan</h3>
                        <form id="contact-form" class="space-y-6">
                            <div><label for="name" class="form-label">Nama Lengkap</label><input type="text" id="name" class="form-input" placeholder="Masukkan nama lengkap Anda" required></div>
                            <div><label for="email" class="form-label">Email</label><input type="email" id="email" class="form-input" placeholder="nama@email.com" required></div>
                            <div><label for="phone" class="form-label">Nomor HP</label><input type="tel" id="phone" class="form-input" placeholder="0812-3456-7890" required></div>
                            <div><label for="subject" class="form-label">Subjek</label><select id="subject" class="form-input"><option value="">Pilih subjek</option><option value="pendaftaran">Pendaftaran Siswa Baru</option><option value="informasi">Informasi Program</option><option value="kemitraan">Kemitraan</option><option value="lainnya">Lainnya</option></select></div>
                            <div><label for="message" class="form-label">Pesan</label><textarea id="message" rows="5" class="form-input" placeholder="Tulis pesan Anda di sini..." required></textarea></div>
                            <button type="submit" class="w-full btn-kemendikbud py-4 text-lg"><i class="fas fa-paper-plane mr-2"></i>Kirim Pesan</button>
                        </form>
                    </div>
                </div>
                
                <div class="lg:w-1/2">
                    <div class="glass-card p-8 h-full">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-6">Informasi Kontak</h3>
                        <div class="space-y-8 mb-8">
                            <div class="flex items-start"><div class="flex-shrink-0 bg-blue-100 p-4 rounded-2xl"><i class="fas fa-map-marker-alt text-blue-600 text-xl"></i></div><div class="ml-6"><h4 class="text-lg font-semibold text-gray-800 mb-2">Alamat</h4><p class="text-gray-600">Jl. Raya Temas No. 123, Kec. Batu, Kota Batu, Jawa Timur 65314</p><button onclick="openMaps()" class="text-blue-600 hover:text-blue-800 mt-2 text-sm flex items-center"><i class="fas fa-directions mr-1"></i>Buka di Google Maps</button></div></div>
                            <div class="flex items-start"><div class="flex-shrink-0 bg-green-100 p-4 rounded-2xl"><i class="fas fa-phone text-green-600 text-xl"></i></div><div class="ml-6"><h4 class="text-lg font-semibold text-gray-800 mb-2">Telepon</h4><div class="space-y-2"><p class="text-gray-600 flex items-center"><i class="fas fa-phone-alt mr-2 text-green-500"></i>(0341) 1234567</p><p class="text-gray-600 flex items-center"><i class="fab fa-whatsapp mr-2 text-green-500"></i>0812-3456-7890</p></div></div></div>
                            <div class="flex items-start"><div class="flex-shrink-0 bg-purple-100 p-4 rounded-2xl"><i class="fas fa-envelope text-purple-600 text-xl"></i></div><div class="ml-6"><h4 class="text-lg font-semibold text-gray-800 mb-2">Email</h4><div class="space-y-2"><p class="text-gray-600">info@smpislamibadurrahman.id</p><p class="text-gray-600">admin@smpislamibadurrahman.id</p></div></div></div>
                        </div>
                        <div><h4 class="text-lg font-semibold text-gray-800 mb-4">Sosial Media</h4><div class="flex space-x-4"><a href="#" class="bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 transition duration-300 shadow-md hover:shadow-lg"><i class="fab fa-facebook-f"></i></a><a href="#" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white p-3 rounded-full hover:opacity-90 transition duration-300 shadow-md hover:shadow-lg"><i class="fab fa-instagram"></i></a><a href="#" class="bg-blue-400 text-white p-3 rounded-full hover:bg-blue-500 transition duration-300 shadow-md hover:shadow-lg"><i class="fab fa-twitter"></i></a><a href="#" class="bg-red-600 text-white p-3 rounded-full hover:bg-red-700 transition duration-300 shadow-md hover:shadow-lg"><i class="fab fa-youtube"></i></a><a href="#" class="bg-green-500 text-white p-3 rounded-full hover:bg-green-600 transition duration-300 shadow-md hover:shadow-lg"><i class="fab fa-whatsapp"></i></a></div></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- E-Learning Section -->
    <section id="e-learning" class="platform-container">
        <div class="container mx-auto px-4 py-12">
            <div class="text-center mb-12">
                <h2 class="section-title">Platform E-Learning Interaktif</h2>
                <p class="text-gray-600 max-w-2xl mx-auto mt-6 text-lg">Sistem pembelajaran online yang lengkap dan interaktif untuk mendukung kegiatan belajar mengajar</p>
            </div>
            
            <div id="login-section" class="max-w-6xl mx-auto">
                <div class="glass-card p-10 relative">
                    <div class="security-badge">
                        <i class="fas fa-lock mr-1"></i>Login Aman
                    </div>
                    
                    <div class="text-center mb-10">
                        <div class="w-24 h-24 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fas fa-graduation-cap text-white text-4xl"></i>
                        </div>
                        <h3 class="text-3xl font-bold text-gray-800 mb-3">Masuk ke Platform</h3>
                        <p class="text-gray-600 text-lg">Pilih peran Anda untuk masuk ke sistem pembelajaran interaktif</p>
                    </div>
                    
                    <!-- Login Security Info -->
                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 mb-8">
                        <div class="flex items-start">
                            <i class="fas fa-shield-alt text-blue-600 text-xl mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-semibold text-blue-800 mb-2">Keamanan Login</h4>
                                <ul class="text-blue-700 space-y-1 text-sm">
                                    <li> Login dilindungi dengan enkripsi end-to-end</li>
                                    <li> Monitoring aktivitas mencurigakan</li>
                                    <li> Notifikasi login baru</li>
                                    <li> Sesi otomatis logout setelah 30 menit tidak aktif</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Login Attempts Warning -->
                    <div id="login-attempts-warning" class="hidden">
                        <div class="login-attempt">
                            <div class="flex items-center">
                                <i class="fas fa-exclamation-triangle text-yellow-600 mr-3"></i>
                                <div>
                                    <p class="font-medium text-yellow-800">Peringatan Keamanan</p>
                                    <p class="text-yellow-700 text-sm">Terlalu banyak percobaan login gagal. Tunggu <span id="lockout-time">5</span> menit.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="login-options" class="grid md:grid-cols-3 gap-8 mb-10">
                        <div class="role-card glass-card p-8 text-center cursor-pointer transition-all duration-300 hover:scale-105" onclick="showLoginForm('santri')">
                            <div class="bg-gradient-to-r from-blue-400 to-blue-600 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
                                <i class="fas fa-user-graduate text-white text-3xl"></i>
                            </div>
                            <h4 class="text-xl font-semibold text-gray-800 mb-3">Santri</h4>
                            <p class="text-gray-600 mb-4">Akses materi, tugas, forum diskusi, dan game edukasi</p>
                            <div class="flex justify-center items-center text-blue-600">
                                <span>Masuk</span>
                                <i class="fas fa-arrow-right ml-2"></i>
                            </div>
                        </div>
                        
                        <div class="role-card glass-card p-8 text-center cursor-pointer transition-all duration-300 hover:scale-105" onclick="showLoginForm('guru')">
                            <div class="bg-gradient-to-r from-green-400 to-green-600 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
                                <i class="fas fa-chalkboard-teacher text-white text-3xl"></i>
                            </div>
                            <h4 class="text-xl font-semibold text-gray-800 mb-3">Guru</h4>
                            <p class="text-gray-600 mb-4">Kelola materi, tugas, nilai santri, dan monitoring</p>
                            <div class="flex justify-center items-center text-green-600">
                                <span>Masuk</span>
                                <i class="fas fa-arrow-right ml-2"></i>
                            </div>
                        </div>
                        
                        <div class="role-card glass-card p-8 text-center cursor-pointer transition-all duration-300 hover:scale-105" onclick="showLoginForm('admin')">
                            <div class="bg-gradient-to-r from-purple-400 to-purple-600 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
                                <i class="fas fa-user-shield text-white text-3xl"></i>
                            </div>
                            <h4 class="text-xl font-semibold text-gray-800 mb-3">Admin</h4>
                            <p class="text-gray-600 mb-4">Kelola sistem, pengguna, dan konten platform</p>
                            <div class="flex justify-center items-center text-purple-600">
                                <span>Masuk</span>
                                <i class="fas fa-arrow-right ml-2"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div id="login-form" class="hidden max-w-md mx-auto">
                        <div class="text-center mb-8">
                            <h3 class="text-2xl font-bold text-gray-800" id="login-role-title">Masuk sebagai Santri</h3>
                            <p class="text-gray-600 mt-2">Masukkan kredensial Anda untuk mengakses platform</p>
                        </div>
                        
                        <div class="space-y-6">
                            <div>
                                <label for="login-email" class="form-label">Email</label>
                                <div class="relative">
                                    <i class="fas fa-envelope absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                    <input type="email" id="login-email" class="form-input pl-12" placeholder="Masukkan email Anda">
                                </div>
                            </div>
                            
                            <div>
                                <label for="login-password" class="form-label">Password</label>
                                <div class="relative">
                                    <i class="fas fa-lock absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                    <input type="password" id="login-password" class="form-input pl-12" placeholder="Masukkan password" oninput="checkPasswordStrength(this.value)">
                                    <button type="button" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600" onclick="togglePassword()">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                                <div id="password-strength" class="password-strength">
                                    <div id="password-strength-bar" class="password-strength-bar"></div>
                                </div>
                                <p id="password-strength-text" class="text-xs text-gray-500 mt-2"></p>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" id="remember-me">
                                    <span class="ml-2 text-gray-600">Ingat saya</span>
                                </label>
                                <button class="text-blue-600 hover:text-blue-800 text-sm" onclick="showForgotPassword()">Lupa password?</button>
                            </div>
                            
                            <!-- Security options -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" id="two-factor-check">
                                    <span class="ml-2 text-gray-600">Gunakan Two-Factor Authentication</span>
                                </label>
                                <p class="text-xs text-gray-500 mt-2">Aktifkan untuk keamanan ekstra dengan kode OTP</p>
                            </div>
                            
                            <input type="hidden" id="login-role">
                            
                            <div class="flex justify-between items-center">
                                <button onclick="showLoginOptions()" class="text-blue-600 hover:text-blue-800 font-medium flex items-center">
                                    <i class="fas fa-arrow-left mr-2"></i>Kembali
                                </button>
                                <button onclick="handleLogin()" class="interactive-btn">
                                    <i class="fas fa-sign-in-alt mr-2"></i>Masuk
                                </button>
                            </div>
                            
                            <div class="text-center pt-6 border-t border-gray-200">
                                <p class="text-sm text-gray-600 mb-2">Gunakan akun demo:</p>
                                <p class="text-sm font-medium text-gray-800" id="demo-email"></p>
                                <p class="text-sm text-gray-600">Password: <span class="font-medium">password123</span></p>
                                <p class="text-xs text-gray-500 mt-2"><i class="fas fa-info-circle mr-1"></i> Password demo tidak aman. Gunakan password kuat untuk akun asli.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="platform-dashboard" class="hidden">
                <div class="glass-card p-8 mb-8">
                    <div class="flex flex-col md:flex-row justify-between items-center">
                        <div class="flex items-center space-x-6 mb-6 md:mb-0">
                            <div class="relative">
                                <img id="dashboard-avatar" src="https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg" alt="User" class="w-20 h-20 rounded-full object-cover border-4 border-white shadow-xl">
                                <div class="absolute -bottom-1 -right-1 w-8 h-8 bg-green-500 rounded-full border-2 border-white flex items-center justify-center">
                                    <i class="fas fa-check text-white text-xs"></i>
                                </div>
                                <div class="absolute -top-1 -right-1 w-6 h-6 bg-blue-500 rounded-full border-2 border-white flex items-center justify-center">
                                    <i class="fas fa-shield-alt text-white text-xs"></i>
                                </div>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">Selamat Datang, <span id="dashboard-username" class="text-blue-600"></span></h2>
                                <div class="flex items-center space-x-4 mt-2">
                                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium" id="dashboard-role"></span>
                                    <span class="text-gray-600 text-sm" id="dashboard-class"></span>
                                    <span class="text-green-600 text-sm" id="login-time"></span>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="hidden md:flex items-center space-x-3 bg-gradient-to-r from-yellow-400 to-yellow-500 px-6 py-3 rounded-full shadow-lg">
                                <i class="fas fa-coins text-white"></i>
                                <span class="font-bold text-white text-lg" id="user-points">0</span>
                                <span class="text-white">Poin</span>
                            </div>
                            <button id="admin-panel-btn" class="hidden interactive-btn bg-gradient-to-r from-purple-500 to-purple-700">
                                <i class="fas fa-cog mr-2"></i>Panel Admin
                            </button>
                            <button onclick="showSecuritySettings()" class="interactive-btn bg-gradient-to-r from-green-500 to-green-600">
                                <i class="fas fa-shield-alt mr-2"></i>Keamanan
                            </button>
                            <button onclick="logout()" class="interactive-btn bg-gradient-to-r from-red-500 to-red-600">
                                <i class="fas fa-sign-out-alt mr-2"></i>Logout
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Enhanced Admin Panel -->
                <div id="enhanced-admin-panel" class="hidden glass-card p-8 mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Panel Admin Lengkap</h2>
                    
                    <!-- Admin Tabs -->
                    <div class="flex flex-wrap gap-2 mb-8">
                        <button class="admin-tab-btn interactive-btn bg-gradient-to-r from-blue-500 to-blue-600 active" onclick="showAdminTab('dashboard')">Dashboard</button>
                        <button class="admin-tab-btn interactive-btn bg-gradient-to-r from-green-500 to-green-600" onclick="showAdminTab('users')">Manajemen User</button>
                        <button class="admin-tab-btn interactive-btn bg-gradient-to-r from-purple-500 to-purple-600" onclick="showAdminTab('security')">Keamanan</button>
                        <button class="admin-tab-btn interactive-btn bg-gradient-to-r from-yellow-500 to-yellow-600" onclick="showAdminTab('reports')">Laporan</button>
                        <button class="admin-tab-btn interactive-btn bg-gradient-to-r from-red-500 to-red-600" onclick="showAdminTab('audit')">Audit Log</button>
                        <button class="admin-tab-btn interactive-btn bg-gradient-to-r from-indigo-500 to-indigo-600" onclick="showAdminTab('settings')">Pengaturan</button>
                    </div>
                    
                    <!-- Admin Dashboard Tab -->
                    <div id="admin-dashboard-tab" class="admin-tab-content active">
                        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div class="stat-card">
                                <div class="stat-icon bg-blue-100 text-blue-600">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-value" id="total-users">0</div>
                                <div class="stat-label">Total Pengguna</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon bg-green-100 text-green-600">
                                    <i class="fas fa-sign-in-alt"></i>
                                </div>
                                <div class="stat-value" id="active-sessions">0</div>
                                <div class="stat-label">Sesi Aktif</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon bg-purple-100 text-purple-600">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="stat-value" id="security-events">0</div>
                                <div class="stat-label">Event Keamanan</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon bg-red-100 text-red-600">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="stat-value" id="failed-logins">0</div>
                                <div class="stat-label">Login Gagal</div>
                            </div>
                        </div>
                        
                        <div class="grid lg:grid-cols-2 gap-8 mb-8">
                            <div class="admin-chart">
                                <h4 class="text-lg font-semibold text-gray-800 mb-4">Aktivitas Pengguna (7 Hari)</h4>
                                <div id="user-activity-chart-placeholder" class="w-full h-64 flex items-center justify-center">
                                    <p class="text-gray-500">Chart akan dimuat di sini</p>
                                </div>
                            </div>
                            <div class="admin-chart">
                                <h4 class="text-lg font-semibold text-gray-800 mb-4">Distribusi Pengguna</h4>
                                <div id="user-distribution-chart-placeholder" class="w-full h-64 flex items-center justify-center">
                                    <p class="text-gray-500">Chart akan dimuat di sini</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- User Management Tab -->
                    <div id="admin-users-tab" class="admin-tab-content">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold text-gray-800">Manajemen Pengguna</h3>
                            <button onclick="showAddUserModal()" class="interactive-btn bg-gradient-to-r from-green-500 to-green-600">
                                <i class="fas fa-user-plus mr-2"></i>Tambah User
                            </button>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Nama</th>
                                        <th>Email</th>
                                        <th>Role</th>
                                        <th>Status</th>
                                        <th>Terakhir Login</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-users-table">
                                    <!-- Data akan di-load secara dinamis -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="mt-8">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">Filter Pengguna</h4>
                            <div class="flex flex-wrap gap-4">
                                <select id="user-role-filter" class="form-input w-auto">
                                    <option value="">Semua Role</option>
                                    <option value="admin">Admin</option>
                                    <option value="guru">Guru</option>
                                    <option value="santri">Santri</option>
                                </select>
                                <select id="user-status-filter" class="form-input w-auto">
                                    <option value="">Semua Status</option>
                                    <option value="active">Aktif</option>
                                    <option value="inactive">Tidak Aktif</option>
                                </select>
                                <button onclick="filterUsers()" class="interactive-btn bg-gradient-to-r from-blue-500 to-blue-600">
                                    <i class="fas fa-filter mr-2"></i>Filter
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Security Tab -->
                    <div id="admin-security-tab" class="admin-tab-content">
                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="security-settings">
                                <h3 class="text-xl font-semibold text-gray-800 mb-6">Pengaturan Keamanan</h3>
                                
                                <div class="space-y-6">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium text-gray-800">Two-Factor Authentication</p>
                                            <p class="text-sm text-gray-600">Wajibkan 2FA untuk semua pengguna</p>
                                        </div>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="require-2fa">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium text-gray-800">Lockout Akun</p>
                                            <p class="text-sm text-gray-600">Kunci akun setelah 5 percobaan gagal</p>
                                        </div>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="enable-lockout" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium text-gray-800">Session Timeout</p>
                                            <p class="text-sm text-gray-600">Auto logout setelah 30 menit</p>
                                        </div>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="enable-timeout" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium text-gray-800">Login History</p>
                                            <p class="text-sm text-gray-600">Simpan riwayat login 90 hari</p>
                                        </div>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="save-login-history" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="mt-8">
                                    <button onclick="saveSecuritySettings()" class="w-full interactive-btn bg-gradient-to-r from-blue-500 to-blue-600">
                                        <i class="fas fa-save mr-2"></i>Simpan Pengaturan
                                    </button>
                                </div>
                            </div>
                            
                            <div class="security-settings">
                                <h3 class="text-xl font-semibold text-gray-800 mb-6">Event Keamanan</h3>
                                
                                <div class="audit-log" id="security-events-list">
                                    <!-- Security events will be loaded here -->
                                </div>
                                
                                <div class="mt-6">
                                    <button onclick="downloadSecurityReport()" class="w-full interactive-btn bg-gradient-to-r from-green-500 to-green-600">
                                        <i class="fas fa-download mr-2"></i>Download Laporan
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Audit Log Tab -->
                    <div id="admin-audit-tab" class="admin-tab-content">
                        <h3 class="text-xl font-semibold text-gray-800 mb-6">Audit Log System</h3>
                        
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Timestamp</th>
                                        <th>User</th>
                                        <th>Aksi</th>
                                        <th>IP Address</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="audit-log-table">
                                    <!-- Audit logs will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="flex justify-between items-center mt-6">
                            <div class="text-sm text-gray-600">
                                Menampilkan <span id="audit-start">1</span>-<span id="audit-end">10</span> dari <span id="audit-total">0</span> entri
                            </div>
                            <div class="pagination">
                                <button class="pagination-btn" onclick="prevAuditPage()"><i class="fas fa-chevron-left"></i></button>
                                <button class="pagination-btn active">1</button>
                                <button class="pagination-btn">2</button>
                                <button class="pagination-btn">3</button>
                                <button class="pagination-btn" onclick="nextAuditPage()"><i class="fas fa-chevron-right"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Existing Dashboard Navigation -->
                <div class="glass-card p-4 mb-8">
                    <div class="flex flex-wrap gap-3 justify-center">
                        <button class="dashboard-nav interactive-btn bg-gradient-to-r from-blue-500 to-blue-600 active" onclick="showPlatformSection('dashboard')"><i class="fas fa-home mr-2"></i>Dashboard</button>
                        <button class="dashboard-nav interactive-btn bg-gradient-to-r from-green-500 to-green-600" onclick="showPlatformSection('pembelajaran')"><i class="fas fa-book-open mr-2"></i>Pembelajaran</button>
                        <button class="dashboard-nav interactive-btn bg-gradient-to-r from-yellow-500 to-yellow-600" onclick="showPlatformSection('game')"><i class="fas fa-gamepad mr-2"></i>Game Edukasi</button>
                        <button class="dashboard-nav interactive-btn bg-gradient-to-r from-purple-500 to-purple-600" onclick="showPlatformSection('tugas')"><i class="fas fa-tasks mr-2"></i>Tugas & PR</button>
                        <button class="dashboard-nav interactive-btn bg-gradient-to-r from-red-500 to-red-600" onclick="showPlatformSection('quiz')"><i class="fas fa-question-circle mr-2"></i>Quiz Interaktif</button>
                        <button class="dashboard-nav interactive-btn bg-gradient-to-r from-indigo-500 to-indigo-600" onclick="showPlatformSection('live')"><i class="fas fa-video mr-2"></i>Kelas Live</button>
                        <button class="dashboard-nav interactive-btn bg-gradient-to-r from-pink-500 to-pink-600" onclick="showPlatformSection('progress')"><i class="fas fa-chart-line mr-2"></i>Progress Belajar</button>
                        <button class="dashboard-nav interactive-btn bg-gradient-to-r from-teal-500 to-teal-600" onclick="showPlatformSection('achievement')"><i class="fas fa-trophy mr-2"></i>Pencapaian</button>
                    </div>
                </div>
                
                <div class="platform-section active" id="dashboard-content">
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="stat-card pulse-animation"><div class="stat-icon bg-blue-100 text-blue-600"><i class="fas fa-book-open"></i></div><div class="stat-value" id="materi-count">0</div><div class="stat-label">Materi Dipelajari</div></div>
                        <div class="stat-card pulse-animation"><div class="stat-icon bg-green-100 text-green-600"><i class="fas fa-tasks"></i></div><div class="stat-value" id="tugas-count">0</div><div class="stat-label">Tugas Diselesaikan</div></div>
                        <div class="stat-card pulse-animation"><div class="stat-icon bg-purple-100 text-purple-600"><i class="fas fa-gamepad"></i></div><div class="stat-value" id="game-count">0</div><div class="stat-label">Game Dimainkan</div></div>
                        <div class="stat-card pulse-animation"><div class="stat-icon bg-yellow-100 text-yellow-600"><i class="fas fa-trophy"></i></div><div class="stat-value" id="poin-count">0</div><div class="stat-label">Poin Dikumpulkan</div></div>
                    </div>
                    
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div class="glass-card p-8">
                            <h3 class="text-xl font-semibold text-gray-800 mb-6">Progress Pembelajaran</h3>
                            <div class="flex flex-col items-center mb-6">
                                <div class="relative w-48 h-48 mb-6">
                                    <svg class="w-48 h-48 progress-ring" viewBox="0 0 100 100">
                                        <circle class="text-gray-200 stroke-current" stroke-width="8" cx="50" cy="50" r="45" fill="transparent"></circle>
                                        <circle class="progress-ring-circle text-blue-500 stroke-current" stroke-width="8" stroke-linecap="round" cx="50" cy="50" r="45" fill="transparent" stroke-dasharray="282.6" stroke-dashoffset="141.3"></circle>
                                    </svg>
                                    <div class="absolute inset-0 flex flex-col items-center justify-center">
                                        <span class="text-4xl font-bold text-gray-800" id="progress-percentage">50%</span>
                                        <span class="text-gray-600 mt-2">Progress</span>
                                    </div>
                                </div>
                                <p class="text-gray-600 text-center" id="progress-text">Menyelesaikan 5 dari 10 modul</p>
                            </div>
                        </div>
                        
                        <div class="glass-card p-8">
                            <h3 class="text-xl font-semibold text-gray-800 mb-6">Aktivitas Terbaru</h3>
                            <div id="recent-activities" class="space-y-4 max-h-96 overflow-y-auto pr-2"></div>
                        </div>
                    </div>
                    
                    <div class="glass-card p-8 mt-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-6">Akses Cepat</h3>
                        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <button onclick="showPlatformSection('pembelajaran')" class="flex flex-col items-center justify-center p-6 bg-blue-50 hover:bg-blue-100 rounded-2xl transition-colors"><i class="fas fa-play-circle text-blue-600 text-3xl mb-3"></i><span class="font-medium text-gray-800">Lanjutkan Belajar</span></button>
                            <button onclick="showPlatformSection('tugas')" class="flex flex-col items-center justify-center p-6 bg-green-50 hover:bg-green-100 rounded-2xl transition-colors"><i class="fas fa-tasks text-green-600 text-3xl mb-3"></i><span class="font-medium text-gray-800">Tugas Mendatang</span></button>
                            <button onclick="showPlatformSection('quiz')" class="flex flex-col items-center justify-center p-6 bg-purple-50 hover:bg-purple-100 rounded-2xl transition-colors"><i class="fas fa-question-circle text-purple-600 text-3xl mb-3"></i><span class="font-medium text-gray-800">Quiz Baru</span></button>
                            <button onclick="showPlatformSection('achievement')" class="flex flex-col items-center justify-center p-6 bg-yellow-50 hover:bg-yellow-100 rounded-2xl transition-colors"><i class="fas fa-trophy text-yellow-600 text-3xl mb-3"></i><span class="font-medium text-gray-800">Pencapaian</span></button>
                        </div>
                    </div>
                </div>
                
                <!-- Other platform sections remain the same -->
                <div class="platform-section" id="pembelajaran-content">
                    <!-- Existing pembelajaran content -->
                </div>
                
                <div class="platform-section" id="game-content">
                    <!-- Existing game content -->
                </div>
                
                <div class="platform-section" id="tugas-content">
                    <!-- Existing tugas content -->
                </div>
                
                <div class="platform-section" id="quiz-content">
                    <!-- Existing quiz content -->
                </div>
                
                <div class="platform-section" id="live-content">
                    <!-- Existing live content -->
                </div>
                
                <div class="platform-section" id="progress-content">
                    <!-- Existing progress content -->
                </div>
                
                <div class="platform-section" id="achievement-content">
                    <!-- Existing achievement content -->
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer-kemendikbud">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-10">
                <div>
                    <div class="flex items-center space-x-3 mb-6">
                        <img src="https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg" alt="Logo SMP Islam Ibadurrahman Temas" class="w-12 h-12 object-contain rounded-full border-2 border-white">
                        <div>
                            <span class="text-xl font-semibold">SMP Islam Ibadurrahman</span>
                            <p class="text-gray-400 text-sm">Temas</p>
                        </div>
                    </div>
                    <p class="text-gray-400 mb-6">Membangun generasi Qur'ani yang berakhlak mulia, berwawasan global, dan berkontribusi bagi umat.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                
                <div>
                    <h4 class="font-semibold text-lg mb-6">Tautan Cepat</h4>
                    <ul class="space-y-3">
                        <li><a href="#home" class="hover:text-white transition-colors">Beranda</a></li>
                        <li><a href="#profile" class="hover:text-white transition-colors">Profil</a></li>
                        <li><a href="#program" class="hover:text-white transition-colors">Program</a></li>
                        <li><a href="#ppdb" class="hover:text-white transition-colors">PPDB</a></li>
                        <li><a href="#spp" class="hover:text-white transition-colors">SPP Online</a></li>
                        <li><a href="#marketplace" class="hover:text-white transition-colors">Marketplace</a></li>
                        <li><a href="#tabungan" class="hover:text-white transition-colors">Tabungan</a></li>
                        <li><a href="#absensi" class="hover:text-white transition-colors">Absensi</a></li>
                        <li><a href="#galeri" class="hover:text-white transition-colors">Galeri</a></li>
                        <li><a href="#kontak" class="hover:text-white transition-colors">Kontak</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-semibold text-lg mb-6">Informasi</h4>
                    <ul class="space-y-3">
                        <li><a href="#" class="hover:text-white transition-colors">Syarat Pendaftaran</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Biaya Pendidikan</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Kalender Akademik</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">FAQ</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Berita & Artikel</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-semibold text-lg mb-6">Kontak</h4>
                    <ul class="space-y-4">
                        <li class="flex items-start"><i class="fas fa-map-marker-alt mt-1 mr-3 text-gray-400"></i><span class="text-gray-400">Jl. Raya Temas No. 123, Kec. Batu, Kota Batu, Jawa Timur 65314</span></li>
                        <li class="flex items-center"><i class="fas fa-phone mr-3 text-gray-400"></i><span class="text-gray-400">(0341) 1234567</span></li>
                        <li class="flex items-center"><i class="fas fa-envelope mr-3 text-gray-400"></i><span class="text-gray-400">info@smpislamibadurrahman.id</span></li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-800 mt-10 pt-8 text-center">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-gray-400 mb-4 md:mb-0"> 2024 SMP Islam Ibadurrahman Temas. All rights reserved.</p>
                    <div class="flex space-x-6">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors text-sm">Privacy Policy</a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors text-sm">Terms of Service</a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors text-sm">Cookie Policy</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Modals (Keep existing modals and add new ones) -->
    <div id="game-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-4xl">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800" id="game-title">Game Edukasi</h3>
                    <button onclick="closeGame()" class="text-gray-500 hover:text-gray-700 text-2xl"><i class="fas fa-times"></i></button>
                </div>
                <div id="game-content"></div>
            </div>
        </div>
    </div>

    <div id="quiz-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-2xl">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800" id="quiz-title">Quiz Interaktif</h3>
                    <div class="flex items-center space-x-4">
                        <div class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium" id="quiz-timer">00:00</div>
                        <button onclick="closeQuiz()" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times text-2xl"></i></button>
                    </div>
                </div>
                <div id="quiz-content"></div>
            </div>
        </div>
    </div>

    <div id="admin-panel-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-6xl">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800">Panel Admin</h3>
                    <button onclick="closeAdminPanel()" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times text-2xl"></i></button>
                </div>
                <div id="admin-content"></div>
            </div>
        </div>
    </div>

    <div id="payment-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-2xl">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800">Pembayaran SPP</h3>
                    <button onclick="closePaymentModal()" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times text-2xl"></i></button>
                </div>
                <div id="payment-content"></div>
            </div>
        </div>
    </div>

    <div id="checkout-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-2xl">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800">Checkout Marketplace</h3>
                    <button onclick="closeCheckoutModal()" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times text-2xl"></i></button>
                </div>
                <div id="checkout-content"></div>
            </div>
        </div>
    </div>

    <div id="setor-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-md">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800">Setor Tabungan</h3>
                    <button onclick="closeSetorModal()" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times text-2xl"></i></button>
                </div>
                <div id="setor-content"></div>
            </div>
        </div>
    </div>

    <div id="tarik-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-md">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800">Tarik Tabungan</h3>
                    <button onclick="closeTarikModal()" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times text-2xl"></i></button>
                </div>
                <div id="tarik-content"></div>
            </div>
        </div>
    </div>

    <!-- QR Scanner Modal -->
    <div id="qr-scanner-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-2xl">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800">QR Code Scanner</h3>
                    <button onclick="closeQRScanner()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                
                <div class="qr-scanner-container mb-6">
                    <div id="qr-reader" class="w-full h-full"></div>
                    <div class="qr-overlay">
                        <div class="qr-frame"></div>
                    </div>
                </div>
                
                <div class="text-center mb-6">
                    <p class="text-gray-600 mb-4">Arahkan kamera ke QR Code absensi yang tersedia di sekolah</p>
                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 inline-block">
                        <p class="text-blue-800 font-medium">
                            <i class="fas fa-clock mr-2"></i>
                            QR Code hari ini: <span id="todays-qr-code" class="font-mono">ABSN-2024-03-15-7A</span>
                        </p>
                    </div>
                </div>
                
                <div id="attendance-result" class="hidden">
                    <div class="bg-green-50 border border-green-200 rounded-xl p-6 mb-6">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-600 text-3xl mr-4"></i>
                            <div>
                                <h4 class="font-semibold text-green-800 mb-1">Absensi Berhasil!</h4>
                                <p class="text-green-700">Siswa: <span id="student-name"></span></p>
                                <p class="text-green-700">Waktu: <span id="attendance-time"></span></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-center gap-4">
                    <button onclick="simulateQRScan()" class="interactive-btn bg-gradient-to-r from-blue-500 to-blue-600">
                        <i class="fas fa-mobile-alt mr-2"></i>Simulasi Scan
                    </button>
                    <button onclick="generateQRCode()" class="interactive-btn bg-gradient-to-r from-purple-500 to-purple-600">
                        <i class="fas fa-qrcode mr-2"></i>Generate QR
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Email Template Preview Modal -->
    <div id="email-preview-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-3xl">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800">Pratinjau Email</h3>
                    <button onclick="closeEmailPreview()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                
                <div class="email-template">
                    <div class="email-header text-center">
                        <img src="https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg" alt="Logo" class="w-16 h-16 mx-auto mb-4 rounded-full bg-white p-2">
                        <h2 class="text-2xl font-bold">SMP Islam Ibadurrahman Temas</h2>
                        <p class="opacity-90">Sistem Notifikasi Digital</p>
                    </div>
                    
                    <div class="email-body">
                        <h3 id="email-subject" class="text-xl font-semibold text-gray-800 mb-4"></h3>
                        <div id="email-content" class="text-gray-700 mb-6">
                            <!-- Email content will be loaded here -->
                        </div>
                        
                        <div class="bg-gray-50 p-4 rounded-lg mb-6">
                            <p class="text-sm text-gray-600 mb-2">Email ini dikirim secara otomatis. Mohon tidak membalas email ini.</p>
                            <p class="text-sm text-gray-600">Untuk pertanyaan, hubungi admin di (0341) 1234567</p>
                        </div>
                        
                        <div class="text-center">
                            <a href="#" class="inline-block interactive-btn bg-gradient-to-r from-blue-500 to-blue-600">
                                <i class="fas fa-external-link-alt mr-2"></i>Buka Portal Sekolah
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 flex justify-between">
                    <button onclick="sendTestNotification()" class="interactive-btn bg-gradient-to-r from-green-500 to-green-600">
                        <i class="fas fa-paper-plane mr-2"></i>Kirim Test Email
                    </button>
                    <button onclick="closeEmailPreview()" class="px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                        Tutup
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Security Modals -->
    <div id="security-settings-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-2xl">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800">Pengaturan Keamanan</h3>
                    <button onclick="closeSecuritySettings()" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times text-2xl"></i></button>
                </div>
                
                <div class="space-y-6">
                    <div class="security-settings">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">Keamanan Akun</h4>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="form-label">Ganti Password</label>
                                <div class="relative mb-2">
                                    <i class="fas fa-lock absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                    <input type="password" id="current-password" class="form-input pl-12" placeholder="Password saat ini">
                                </div>
                                <div class="relative mb-2">
                                    <i class="fas fa-lock absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                    <input type="password" id="new-password" class="form-input pl-12" placeholder="Password baru" oninput="checkPasswordStrength(this.value)">
                                </div>
                                <div class="relative">
                                    <i class="fas fa-lock absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                    <input type="password" id="confirm-password" class="form-input pl-12" placeholder="Konfirmasi password baru">
                                </div>
                                <div id="password-strength-modal" class="password-strength mt-2">
                                    <div id="password-strength-bar-modal" class="password-strength-bar"></div>
                                </div>
                                <p id="password-strength-text-modal" class="text-xs text-gray-500 mt-2"></p>
                            </div>
                            
                            <button onclick="changePassword()" class="w-full interactive-btn bg-gradient-to-r from-blue-500 to-blue-600">
                                <i class="fas fa-key mr-2"></i>Ganti Password
                            </button>
                        </div>
                    </div>
                    
                    <div class="security-settings">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">Two-Factor Authentication</h4>
                        
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-800">Aktifkan 2FA</p>
                                    <p class="text-sm text-gray-600">Tambahkan lapisan keamanan ekstra</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="enable-2fa-personal">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            
                            <div id="2fa-setup" class="hidden">
                                <p class="text-sm text-gray-600 mb-4">Scan QR code dengan aplikasi authenticator:</p>
                                <div class="qr-code-container mx-auto">
                                    <div id="personal-qr-code" class="w-48 h-48 bg-gray-100 flex items-center justify-center">
                                        <p class="text-gray-500">QR Code akan muncul di sini</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="security-settings">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">Riwayat Login</h4>
                        
                        <div id="login-history" class="max-h-60 overflow-y-auto">
                            <!-- Login history will be loaded here -->
                        </div>
                    </div>
                    
                    <div class="security-settings">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">Sesi Aktif</h4>
                        
                        <div id="active-sessions-list">
                            <!-- Active sessions will be loaded here -->
                        </div>
                        
                        <button onclick="logoutOtherSessions()" class="w-full interactive-btn bg-gradient-to-r from-red-500 to-red-600 mt-4">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout Semua Sesi Lain
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div id="add-user-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-2xl">
            <div class="p-8">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-bold text-gray-800">Tambah Pengguna Baru</h3>
                    <button onclick="closeAddUserModal()" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times text-2xl"></i></button>
                </div>
                
                <form id="add-user-form" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label for="new-user-name" class="form-label">Nama Lengkap</label>
                            <input type="text" id="new-user-name" class="form-input" required>
                        </div>
                        <div>
                            <label for="new-user-email" class="form-label">Email</label>
                            <input type="email" id="new-user-email" class="form-input" required>
                        </div>
                        <div>
                            <label for="new-user-role" class="form-label">Role</label>
                            <select id="new-user-role" class="form-input" required>
                                <option value="">Pilih Role</option>
                                <option value="admin">Admin</option>
                                <option value="guru">Guru</option>
                                <option value="santri">Santri</option>
                            </select>
                        </div>
                        <div>
                            <label for="new-user-password" class="form-label">Password</label>
                            <input type="password" id="new-user-password" class="form-input" required oninput="checkNewPasswordStrength(this.value)">
                            <div id="new-password-strength" class="password-strength mt-2">
                                <div id="new-password-strength-bar" class="password-strength-bar"></div>
                            </div>
                            <p id="new-password-strength-text" class="text-xs text-gray-500 mt-2"></p>
                        </div>
                    </div>
                    
                    <div>
                        <label for="new-user-permissions" class="form-label">Permissions</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" name="permissions" value="read">
                                <span class="ml-2 text-gray-600">Read Access</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" name="permissions" value="write">
                                <span class="ml-2 text-gray-600">Write Access</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" name="permissions" value="delete">
                                <span class="ml-2 text-gray-600">Delete Access</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-4">
                        <button type="button" onclick="closeAddUserModal()" class="px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                            Batal
                        </button>
                        <button type="submit" class="interactive-btn bg-gradient-to-r from-green-500 to-green-600">
                            <i class="fas fa-user-plus mr-2"></i>Tambah Pengguna
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-2xl shadow-2xl text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-gray-600">Memuat...</p>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // ===== KEEP ALL EXISTING FUNCTIONS =====
        // Data Storage
        let platformData = {
            siswa: [
                { id: 'IT000078', nama: 'ADRIAN JULIAN MAULANA', email: 'adrian.julian@smpislamibadurrahman.id', ruang: '7A' },
                { id: 'IT000076', nama: 'FAEZA FAIRUS SIHAN', email: 'faeza.fairus@smpislamibadurrahman.id', ruang: '7A' },
                { id: 'IT000077', nama: 'FARRELL SYAHPUTRA HARAHAP', email: 'farrell.syahputra@smpislamibadurrahman.id', ruang: '7A' },
                { id: 'IT000072', nama: 'KHODIJAH', email: 'khodijah@smpislamibadurrahman.id', ruang: '7A' },
                { id: 'IT000082', nama: 'MIKHA SALSABILA WARDHANI', email: 'mikha.salsabila@smpislamibadurrahman.id', ruang: '7A' },
                { id: 'IT000066', nama: 'MUHAMAD SYAFIQ AZZAM', email: 'muhamad.syafiq@smpislamibadurrahman.id', ruang: '7A' },
                { id: 'IT000067', nama: 'MUHAMMAD IQBAL NUGRAHA', email: 'muhammad.iqbal@smpislamibadurrahman.id', ruang: '7A' },
                { id: 'IT000073', nama: 'RAFFI ADI NUGROHO', email: 'raffi.adi@smpislamibadurrahman.id', ruang: '7A' },
                { id: 'IT000069', nama: 'RAIHAN ADI PERMANA', email: 'raihan.adi@smpislamibadurrahman.id', ruang: '7A' },
                { id: 'IT000074', nama: 'RAYYAN FAKHRIZAL PRATAMA', email: 'rayyan.fakhrizal@smpislamibadurrahman.id', ruang: '7A' }
            ],

            guru: [
                {
                    id: 'G001',
                    nama: 'Abdurrahman Suryadi, M.Pd.I',
                    email: 'abdurrahman.suryadi@smpislamibadurrahman.id',
                    mapel: 'Nahwu',
                    pendidikan: 'S-2 Pendidikan Agama Islam',
                    tempatLahir: 'Narmada',
                    tanggalLahir: '27-11-1984'
                }
            ],

            materi: [
                {
                    id: '1',
                    judul: 'Pengenalan Bentuk Aljabar',
                    mapel: 'Matematika',
                    deskripsi: 'Materi interaktif pengenalan dasar-dasar aljabar untuk kelas 7',
                    konten: 'konten-materi-aljabar',
                    kesulitan: 'Pemula',
                    pembuat: 'Ustadz Surahman, S.Pd',
                    tanggal: new Date().toISOString(),
                    tipe: 'interaktif',
                    poin: 50
                }
            ],
            
            ppdbData: {
                registered: 125,
                quota: 200,
                startDate: '2024-01-01',
                endDate: '2024-06-30',
                fee: 250000,
                applications: []
            },
            
            sppData: {
                monthlyFee: 350000,
                students: {},
                payments: []
            },
            
            marketplaceData: {
                products: [
                    { id: 'P001', name: 'Seragam Putih Biru', category: 'seragam', price: 150000, discount: 10, stock: 50, description: 'Seragam putih biru SMP Islam Ibadurrahman' },
                    { id: 'P002', name: 'Seragam Olahraga', category: 'seragam', price: 120000, discount: 15, stock: 30, description: 'Seragam olahraga sekolah' },
                    { id: 'P003', name: 'Buku Paket Matematika', category: 'buku', price: 75000, discount: 5, stock: 100, description: 'Buku paket matematika kelas 7' },
                    { id: 'P004', name: 'Alat Tulis Lengkap', category: 'buku', price: 50000, discount: 0, stock: 200, description: 'Paket alat tulis lengkap' },
                    { id: 'P005', name: 'Snack Box Sehat', category: 'makanan', price: 25000, discount: 20, stock: 80, description: 'Snack box sehat untuk siswa' },
                    { id: 'P006', name: 'Minuman Vitamin C', category: 'makanan', price: 10000, discount: 0, stock: 150, description: 'Minuman vitamin C' },
                    { id: 'P007', name: 'Tas Sekolah', category: 'lainnya', price: 200000, discount: 25, stock: 40, description: 'Tas sekolah ergonomis' },
                    { id: 'P008', name: 'Mukena Sekolah', category: 'lainnya', price: 85000, discount: 10, stock: 60, description: 'Mukena praktis untuk shalat' }
                ],
                cart: []
            },
            
            tabunganData: {
                accounts: [],
                transactions: []
            },

            tugas: [],
            diskusi: [],
            quizHistory: [],
            nilai: {},
            userProgress: {},
            userPoints: {},
            events: [],
            gameData: {
                'math-puzzle': {
                    title: 'Teka-Teki Matematika',
                    description: 'Asah kemampuan matematika dengan teka-teki menyenangkan',
                    type: 'puzzle',
                    questions: [
                        {
                            question: 'Jika 2x + 5 = 15, berapa nilai x?',
                            options: ['3', '5', '7', '10'],
                            answer: 1,
                            explanation: '2x + 5 = 15  2x = 10  x = 5'
                        }
                    ]
                }
            },
            quizData: {
                matematika: [
                    {
                        pertanyaan: 'Berapakah hasil dari 3x + 2y jika x = 2 dan y = 3?',
                        pilihan: ['12', '10', '8', '6'],
                        jawaban: 0
                    }
                ]
            }
        };

        // ===== ABSENSI & KEHADIRAN DATA =====
        const attendanceData = {
            students: [],
            attendanceRecords: [],
            qrCodes: {},
            notificationSettings: {
                absence: true,
                late: true,
                weekly: true,
                whatsapp: true,
                email: true,
                sms: false
            }
        };

        // ===== WEBSOCKET SIMULATION =====
        let wsConnection = null;
        let isConnected = false;
        let reconnectAttempts = 0;
        const maxReconnectAttempts = 5;

        // ===== NOTIFICATION SYSTEM =====
        const notificationSystem = {
            notifications: [],
            templates: {
                absence: {
                    subject: 'Pemberitahuan Ketidakhadiran Siswa',
                    content: (studentName, date) => `
                        <p>Kepada Yth. Orang Tua/Wali dari <strong>${studentName}</strong>,</p>
                        <p>Kami ingin memberitahukan bahwa anak Anda <strong>tidak hadir</strong> pada tanggal <strong>${date}</strong>.</p>
                        <p>Mohon konfirmasi alasan ketidakhadiran melalui portal orang tua atau hubungi wali kelas.</p>
                    `
                },
                late: {
                    subject: 'Pemberitahuan Keterlambatan Siswa',
                    content: (studentName, time) => `
                        <p>Kepada Yth. Orang Tua/Wali dari <strong>${studentName}</strong>,</p>
                        <p>Anak Anda tercatat <strong>terlambat</strong> masuk sekolah pada pukul <strong>${time}</strong> hari ini.</p>
                        <p>Batas waktu masuk adalah pukul 07:00 WIB.</p>
                    `
                },
                spp: {
                    subject: 'Pengingat Pembayaran SPP',
                    content: (month, dueDate, amount) => `
                        <p>Kepada Yth. Orang Tua/Wali,</p>
                        <p>Ini adalah pengingat bahwa pembayaran SPP untuk bulan <strong>${month}</strong> akan jatuh tempo pada <strong>${dueDate}</strong>.</p>
                        <p>Jumlah yang harus dibayar: <strong>${amount}</strong></p>
                        <p>Silakan lakukan pembayaran sebelum tanggal jatuh tempo untuk menghindari denda.</p>
                    `
                },
                grade: {
                    subject: 'Pengumuman Nilai Ujian',
                    content: (studentName, subject, score) => `
                        <p>Kepada Yth. Orang Tua/Wali dari <strong>${studentName}</strong>,</p>
                        <p>Nilai ujian <strong>${subject}</strong> telah diumumkan.</p>
                        <p>Nilai yang diperoleh: <strong>${score}</strong></p>
                        <p>Detail lengkap dapat dilihat di portal orang tua.</p>
                    `
                },
                event: {
                    subject: 'Pengumuman Kegiatan Sekolah',
                    content: (eventName, date, time) => `
                        <p>Kepada Yth. Orang Tua/Wali,</p>
                        <p>Kami ingin menginformasikan tentang kegiatan sekolah:</p>
                        <p><strong>${eventName}</strong></p>
                        <p>Tanggal: ${date}</p>
                        <p>Waktu: ${time}</p>
                        <p>Mohon persiapkan anak Anda untuk mengikuti kegiatan tersebut.</p>
                    `
                },
                task: {
                    subject: 'Pengingat Deadline Tugas',
                    content: (studentName, taskName, deadline) => `
                        <p>Kepada Yth. Orang Tua/Wali dari <strong>${studentName}</strong>,</p>
                        <p>Tugas <strong>${taskName}</strong> akan jatuh tempo pada <strong>${deadline}</strong>.</p>
                        <p>Mohon ingatkan anak Anda untuk menyelesaikan tugas tepat waktu.</p>
                    `
                }
            }
        };

        // ===== ENHANCED SECURITY DATA =====
        const securityConfig = {
            maxLoginAttempts: 5,
            lockoutDuration: 5 * 60 * 1000, // 5 minutes
            sessionTimeout: 30 * 60 * 1000, // 30 minutes
            require2FA: false,
            saveLoginHistory: true,
            enableAuditLog: true
        };

        const enhancedUserData = {
            users: [],
            sessions: [],
            loginHistory: [],
            auditLogs: [],
            failedAttempts: {},
            securityEvents: []
        };

        // Global variables
        let currentUser = null;
        let currentQuiz = null;
        let currentGame = null;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let gameScore = 0;
        let quizTimer = null;
        let quizTimeLeft = 0;
        let shoppingCart = [];
        let currentTabunganAccount = null;
        let sessionTimer;
        let sessionWarningTimer;

        // ===== KEEP ALL EXISTING UTILITY FUNCTIONS =====
        function showToast(message, type = 'info', duration = 5000) {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<div class="flex items-start"><div class="flex-shrink-0"><i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'} text-${type === 'success' ? 'green' : type === 'error' ? 'red' : type === 'warning' ? 'yellow' : 'blue'}-600 mr-3 mt-1"></i></div><div class="flex-1"><p class="text-gray-800">${message}</p></div><button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times"></i></button></div>`;
            document.getElementById('toast-container').appendChild(toast);
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => { toast.classList.remove('show'); setTimeout(() => toast.remove(), 300); }, duration);
        }

        function showLoading() { document.getElementById('loading-overlay').classList.remove('hidden'); }
        function hideLoading() { document.getElementById('loading-overlay').classList.add('hidden'); }
        function openMaps() { const address = encodeURIComponent('Jl. Raya Temas No. 123, Kec. Batu, Kota Batu, Jawa Timur 65314'); window.open(`https://www.google.com/maps/search/?api=1&query=${address}`, '_blank'); }
        function togglePassword() { const passwordInput = document.getElementById('login-password'); const eyeIcon = passwordInput.nextElementSibling.querySelector('i'); if (passwordInput.type === 'password') { passwordInput.type = 'text'; eyeIcon.className = 'fas fa-eye-slash'; } else { passwordInput.type = 'password'; eyeIcon.className = 'fas fa-eye'; } }

        // ===== ENHANCED SECURITY FUNCTIONS =====
        function checkPasswordStrength(password) {
            const strengthBar = document.getElementById('password-strength-bar');
            const strengthText = document.getElementById('password-strength-text');
            let strength = 0;
            let text = '';
            let colorClass = '';

            if (password.length >= 8) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;

            switch(strength) {
                case 0:
                    text = 'Sangat Lemah';
                    colorClass = 'strength-weak';
                    break;
                case 1:
                    text = 'Lemah';
                    colorClass = 'strength-weak';
                    break;
                case 2:
                    text = 'Cukup';
                    colorClass = 'strength-fair';
                    break;
                case 3:
                    text = 'Baik';
                    colorClass = 'strength-good';
                    break;
                case 4:
                    text = 'Sangat Kuat';
                    colorClass = 'strength-strong';
                    break;
            }

            if (strengthBar) {
                strengthBar.className = `password-strength-bar ${colorClass}`;
                strengthBar.style.width = `${strength * 25}%`;
            }
            if (strengthText) {
                strengthText.textContent = `Kekuatan password: ${text}`;
                strengthText.className = `text-xs mt-2 ${colorClass === 'strength-weak' ? 'text-red-600' : 
                                          colorClass === 'strength-fair' ? 'text-yellow-600' : 
                                          colorClass === 'strength-good' ? 'text-green-600' : 'text-green-700'}`;
            }
        }

        function checkNewPasswordStrength(password) {
            const strengthBar = document.getElementById('new-password-strength-bar');
            const strengthText = document.getElementById('new-password-strength-text');
            
            checkPasswordStrength(password);
            
            if (strengthBar) {
                const mainStrengthBar = document.getElementById('password-strength-bar');
                if (mainStrengthBar) {
                    strengthBar.style.width = mainStrengthBar.style.width;
                    strengthBar.className = mainStrengthBar.className;
                }
            }
            if (strengthText) {
                const mainStrengthText = document.getElementById('password-strength-text');
                if (mainStrengthText) {
                    strengthText.textContent = mainStrengthText.textContent;
                    strengthText.className = mainStrengthText.className;
                }
            }
        }

        function trackLoginAttempt(email, success, ip = '127.0.0.1') {
            if (!enhancedUserData.failedAttempts[email]) {
                enhancedUserData.failedAttempts[email] = {
                    count: 0,
                    lastAttempt: null,
                    lockedUntil: null
                };
            }

            const attempt = enhancedUserData.failedAttempts[email];

            if (!success) {
                attempt.count++;
                attempt.lastAttempt = new Date().toISOString();
                
                if (attempt.count >= securityConfig.maxLoginAttempts) {
                    attempt.lockedUntil = new Date(Date.now() + securityConfig.lockoutDuration);
                    addSecurityEvent('ACCOUNT_LOCKED', `Akun ${email} terkunci karena terlalu banyak percobaan gagal`);
                    showToast('Akun terkunci. Coba lagi setelah 5 menit.', 'error');
                }
            } else {
                attempt.count = 0;
                attempt.lockedUntil = null;
            }

            if (securityConfig.saveLoginHistory) {
                enhancedUserData.loginHistory.unshift({
                    email: email,
                    timestamp: new Date().toISOString(),
                    success: success,
                    ip: ip,
                    userAgent: navigator.userAgent
                });
                
                if (enhancedUserData.loginHistory.length > 100) {
                    enhancedUserData.loginHistory.pop();
                }
            }

            saveSecurityData();
        }

        function addSecurityEvent(type, description) {
            const event = {
                type: type,
                description: description,
                timestamp: new Date().toISOString(),
                user: currentUser ? currentUser.email : 'system',
                ip: '127.0.0.1'
            };

            enhancedUserData.securityEvents.unshift(event);
            
            if (securityConfig.enableAuditLog) {
                enhancedUserData.auditLogs.unshift({
                    timestamp: event.timestamp,
                    user: event.user,
                    action: event.description,
                    ip: event.ip,
                    status: type.includes('FAILED') || type.includes('LOCKED') ? 'ERROR' : 'SUCCESS'
                });
                
                if (enhancedUserData.auditLogs.length > 500) {
                    enhancedUserData.auditLogs.pop();
                }
            }

            saveSecurityData();
            updateSecurityEventsDisplay();
        }

        function updateSecurityEventsDisplay() {
            const eventsList = document.getElementById('security-events-list');
            if (!eventsList) return;
            
            const recentEvents = enhancedUserData.securityEvents.slice(0, 10);
            eventsList.innerHTML = recentEvents.map(event => `
                <div class="audit-log-item ${event.type.includes('FAILED') || event.type.includes('LOCKED') ? 'error' : 'success'}">
                    <div class="flex justify-between">
                        <span class="font-medium">${event.description}</span>
                        <span class="text-sm text-gray-500">${formatTime(event.timestamp)}</span>
                    </div>
                    <div class="text-xs text-gray-600 mt-1">
                        ${event.user}  ${event.ip}
                    </div>
                </div>
            `).join('');
        }

        function formatTime(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleTimeString('id-ID', {
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function isAccountLocked(email) {
            const attempt = enhancedUserData.failedAttempts[email];
            if (!attempt || !attempt.lockedUntil) return false;
            
            const lockedUntil = new Date(attempt.lockedUntil);
            const now = new Date();
            
            if (now < lockedUntil) {
                const minutesLeft = Math.ceil((lockedUntil - now) / 60000);
                document.getElementById('lockout-time').textContent = minutesLeft;
                document.getElementById('login-attempts-warning').classList.remove('hidden');
                return true;
            } else {
                attempt.lockedUntil = null;
                document.getElementById('login-attempts-warning').classList.add('hidden');
                return false;
            }
        }

        // ===== ENHANCED LOGIN HANDLER =====
        function handleLogin() {
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;
            const role = document.getElementById('login-role').value;
            const require2FA = document.getElementById('two-factor-check')?.checked || false;

            if (isAccountLocked(email)) {
                showToast('Akun terkunci. Tunggu beberapa menit dan coba lagi.', 'error');
                return;
            }

            let user = null;
            let success = false;

            if (role === 'santri') {
                user = platformData.siswa.find(s => s.email === email);
                success = user && password === 'password123';
            } else if (role === 'guru') {
                user = platformData.guru.find(g => g.email === email);
                success = user && password === 'password123';
            } else if (role === 'admin') {
                success = email === 'admin@smpislamibadurrahman.id' && password === 'password123';
                if (success) {
                    user = { email: email, name: 'Administrator', role: 'admin' };
                }
            }

            trackLoginAttempt(email, success);

            if (!success) {
                showToast('Email atau password salah!', 'error');
                addSecurityEvent('LOGIN_FAILED', `Percobaan login gagal untuk ${email}`);
                return;
            }

            if (require2FA) {
                currentUser = {
                    email: email,
                    role: role,
                    name: user ? user.nama || user.name : email.split('@')[0],
                    kelas: user ? user.ruang : null,
                    initials: getInitials(user ? user.nama || user.name : 'User'),
                    pending2FA: true
                };
                showTwoFactorModal();
                return;
            }

            completeLogin(user, role, email);
        }

        function completeLogin(user, role, email) {
            showLoading();
            setTimeout(() => {
                if (!currentUser) {
                    currentUser = {
                        email: email,
                        role: role,
                        name: user ? user.nama || user.name : email.split('@')[0],
                        kelas: user ? user.ruang : null,
                        initials: getInitials(user ? user.nama || user.name : 'User'),
                        loginTime: new Date().toISOString(),
                        sessionId: generateSessionId()
                    };
                }

                enhancedUserData.sessions.push({
                    sessionId: currentUser.sessionId,
                    email: currentUser.email,
                    loginTime: currentUser.loginTime,
                    lastActivity: new Date().toISOString(),
                    ip: '127.0.0.1',
                    userAgent: navigator.userAgent
                });

                if (!platformData.userProgress[currentUser.email]) {
                    platformData.userProgress[currentUser.email] = {
                        completedMateri: [],
                        completedGames: [],
                        completedTugas: [],
                        lastLogin: new Date().toISOString()
                    };
                } else {
                    platformData.userProgress[currentUser.email].lastLogin = new Date().toISOString();
                }

                addSecurityEvent('LOGIN_SUCCESS', `Login berhasil untuk ${currentUser.email}`);

                savePlatformData();
                saveSecurityData();
                document.getElementById('login-section').classList.add('hidden');
                document.getElementById('platform-dashboard').classList.remove('hidden');
                updateDashboardUI();
                hideLoading();
                showToast(`Login berhasil! Selamat datang ${currentUser.name}`, 'success');
                updateMobileUserMenu();

                startSessionTimer();

                const now = new Date();
                document.getElementById('login-time').textContent = 
                    `Login: ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            }, 1000);
        }

        function generateSessionId() {
            return 'session_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
        }

        // ===== SESSION MANAGEMENT =====
        function startSessionTimer() {
            if (sessionTimer) clearTimeout(sessionTimer);
            if (sessionWarningTimer) clearTimeout(sessionWarningTimer);

            sessionWarningTimer = setTimeout(() => {
                showSessionWarning();
            }, securityConfig.sessionTimeout - (5 * 60 * 1000));

            sessionTimer = setTimeout(() => {
                logout();
                showToast('Sesi telah berakhir karena tidak aktif', 'info');
            }, securityConfig.sessionTimeout);
        }

        function showSessionWarning() {
            const warningDiv = document.getElementById('session-timeout-warning');
            const countdown = document.getElementById('session-countdown');
            
            let timeLeft = 5 * 60;
            warningDiv.style.display = 'block';

            const countdownInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                countdown.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(countdownInterval);
                }
            }, 1000);
        }

        function extendSession() {
            startSessionTimer();
            document.getElementById('session-timeout-warning').style.display = 'none';
            showToast('Sesi diperpanjang', 'success');
        }

        // ===== ENHANCED LOGOUT =====
        function logout() {
            if (currentUser) {
                enhancedUserData.sessions = enhancedUserData.sessions.filter(
                    session => session.sessionId !== currentUser.sessionId
                );
                
                addSecurityEvent('LOGOUT', `Logout untuk ${currentUser.email}`);
            }

            if (sessionTimer) clearTimeout(sessionTimer);
            if (sessionWarningTimer) clearTimeout(sessionWarningTimer);
            
            document.getElementById('session-timeout-warning').style.display = 'none';

            currentUser = null;
            document.getElementById('platform-dashboard').classList.add('hidden');
            document.getElementById('enhanced-admin-panel').classList.add('hidden');
            document.getElementById('login-section').classList.remove('hidden');
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('login-options').classList.remove('hidden');
            document.getElementById('user-menu').classList.add('hidden');
            document.getElementById('mobile-user-menu').classList.add('hidden');
            
            showToast('Anda telah logout dari platform', 'info');
            saveSecurityData();
        }

        // ===== TWO-FACTOR AUTHENTICATION =====
        function showTwoFactorModal() {
            document.getElementById('two-factor-modal').classList.add('active');
            
            setTimeout(() => {
                document.getElementById('qr-code-placeholder').innerHTML = `
                    <div class="text-center">
                        <div class="w-32 h-32 bg-gradient-to-r from-blue-500 to-purple-600 mx-auto mb-4 flex items-center justify-center rounded-lg">
                            <i class="fas fa-qrcode text-white text-4xl"></i>
                        </div>
                        <p class="text-sm text-gray-600">QR Code Simulasi</p>
                        <p class="text-xs text-gray-500">Gunakan kode: 123456</p>
                    </div>
                `;
            }, 500);
        }

        function cancelTwoFactor() {
            document.getElementById('two-factor-modal').classList.remove('active');
            currentUser = null;
            showToast('Login dibatalkan', 'info');
        }

        function verifyTwoFactor() {
            const inputs = document.querySelectorAll('.otp-input');
            let code = '';
            inputs.forEach(input => code += input.value);
            
            if (code === '123456') {
                document.getElementById('two-factor-modal').classList.remove('active');
                currentUser.pending2FA = false;
                completeLogin(null, currentUser.role, currentUser.email);
                addSecurityEvent('2FA_SUCCESS', `Two-factor authentication berhasil untuk ${currentUser.email}`);
            } else {
                document.getElementById('otp-error').classList.remove('hidden');
                addSecurityEvent('2FA_FAILED', `Two-factor authentication gagal untuk ${currentUser.email}`);
            }
        }

        function moveToNext(input, nextIndex) {
            if (input.value.length === 1) {
                if (nextIndex <= 6) {
                    document.querySelector(`.otp-input:nth-child(${nextIndex})`).focus();
                }
            }
        }

        function showRecoveryOptions() {
            showToast('Fitur pemulihan akun akan segera hadir', 'info');
        }

        // ===== ADMIN DASHBOARD FUNCTIONS =====
        function showAdminTab(tabName) {
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.admin-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`admin-${tabName}-tab`).classList.add('active');
            event.target.classList.add('active');
            
            loadAdminTabData(tabName);
        }

        function loadAdminTabData(tabName) {
            switch(tabName) {
                case 'dashboard':
                    loadAdminDashboard();
                    break;
                case 'users':
                    loadUsersManagement();
                    break;
                case 'security':
                    loadSecurityTab();
                    break;
                case 'audit':
                    loadAuditLog();
                    break;
            }
        }

        function loadAdminDashboard() {
            const totalUsers = platformData.siswa.length + platformData.guru.length + 1;
            document.getElementById('total-users').textContent = totalUsers;
            document.getElementById('active-sessions').textContent = enhancedUserData.sessions.length;
            document.getElementById('security-events').textContent = enhancedUserData.securityEvents.length;
            document.getElementById('failed-logins').textContent = 
                Object.values(enhancedUserData.failedAttempts).reduce((sum, attempt) => sum + attempt.count, 0);

            updateSecurityEventsDisplay();
        }

        function loadUsersManagement() {
            const tableBody = document.getElementById('admin-users-table');
            if (!tableBody) return;

            let users = [];

            platformData.siswa.forEach(siswa => {
                users.push({
                    name: siswa.nama,
                    email: siswa.email,
                    role: 'santri',
                    status: 'active',
                    lastLogin: platformData.userProgress[siswa.email]?.lastLogin || '-'
                });
            });

            platformData.guru.forEach(guru => {
                users.push({
                    name: guru.nama,
                    email: guru.email,
                    role: 'guru',
                    status: 'active',
                    lastLogin: platformData.userProgress[guru.email]?.lastLogin || '-'
                });
            });

            users.push({
                name: 'Administrator',
                email: 'admin@smpislamibadurrahman.id',
                role: 'admin',
                status: 'active',
                lastLogin: new Date().toISOString().split('T')[0]
            });

            tableBody.innerHTML = users.map(user => `
                <tr>
                    <td class="font-medium">${user.name}</td>
                    <td>${user.email}</td>
                    <td>
                        <span class="permission-${user.role} permission-badge">
                            ${user.role.toUpperCase()}
                        </span>
                    </td>
                    <td>
                        <div class="user-status">
                            <span class="status-dot status-${user.status}"></span>
                            ${user.status === 'active' ? 'Aktif' : 'Tidak Aktif'}
                        </div>
                    </td>
                    <td>${formatDate(user.lastLogin)}</td>
                    <td>
                        <div class="admin-table-actions">
                            <button class="edit-btn" onclick="editUser('${user.email}')">
                                <i class="fas fa-edit mr-1"></i>Edit
                            </button>
                            <button class="delete-btn" onclick="deleteUser('${user.email}')">
                                <i class="fas fa-trash mr-1"></i>Hapus
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function formatDate(dateString) {
            if (!dateString || dateString === '-') return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
        }

        function showAddUserModal() {
            document.getElementById('add-user-modal').classList.add('active');
        }

        function closeAddUserModal() {
            document.getElementById('add-user-modal').classList.remove('active');
            document.getElementById('add-user-form').reset();
        }

        function loadSecurityTab() {
            document.getElementById('require-2fa').checked = securityConfig.require2FA;
            document.getElementById('enable-lockout').checked = securityConfig.maxLoginAttempts > 0;
            document.getElementById('enable-timeout').checked = securityConfig.sessionTimeout > 0;
            document.getElementById('save-login-history').checked = securityConfig.saveLoginHistory;

            updateSecurityEventsDisplay();
        }

        function saveSecuritySettings() {
            securityConfig.require2FA = document.getElementById('require-2fa').checked;
            securityConfig.maxLoginAttempts = document.getElementById('enable-lockout').checked ? 5 : 0;
            securityConfig.sessionTimeout = document.getElementById('enable-timeout').checked ? 30 * 60 * 1000 : 0;
            securityConfig.saveLoginHistory = document.getElementById('save-login-history').checked;
            
            localStorage.setItem('securityConfig', JSON.stringify(securityConfig));
            showToast('Pengaturan keamanan disimpan', 'success');
            addSecurityEvent('SECURITY_SETTINGS_UPDATED', 'Pengaturan keamanan diperbarui');
        }

        function loadAuditLog() {
            const tableBody = document.getElementById('audit-log-table');
            if (!tableBody) return;

            const logs = enhancedUserData.auditLogs.slice(0, 20);
            
            tableBody.innerHTML = logs.map(log => `
                <tr>
                    <td>${formatDateTime(log.timestamp)}</td>
                    <td class="font-medium">${log.user}</td>
                    <td>${log.action}</td>
                    <td class="text-sm text-gray-600">${log.ip}</td>
                    <td>
                        <span class="px-2 py-1 rounded text-xs font-medium ${
                            log.status === 'SUCCESS' ? 'bg-green-100 text-green-800' :
                            log.status === 'WARNING' ? 'bg-yellow-100 text-yellow-800' :
                            'bg-red-100 text-red-800'
                        }">
                            ${log.status}
                        </span>
                    </td>
                </tr>
            `).join('');

            document.getElementById('audit-total').textContent = enhancedUserData.auditLogs.length;
            document.getElementById('audit-start').textContent = '1';
            document.getElementById('audit-end').textContent = Math.min(20, enhancedUserData.auditLogs.length);
        }

        function formatDateTime(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleString('id-ID', {
                day: '2-digit',
                month: 'short',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function prevAuditPage() {
            showToast('Halaman sebelumnya', 'info');
        }

        function nextAuditPage() {
            showToast('Halaman berikutnya', 'info');
        }

        function filterUsers() {
            showToast('Filter diterapkan', 'info');
        }

        function editUser(email) {
            showToast(`Edit user ${email}`, 'info');
        }

        function deleteUser(email) {
            if (confirm(`Apakah Anda yakin ingin menghapus user ${email}?`)) {
                showToast(`User ${email} dihapus`, 'success');
                addSecurityEvent('USER_DELETED', `User ${email} dihapus dari sistem`);
            }
        }

        // ===== USER SECURITY FUNCTIONS =====
        function showSecuritySettings() {
            document.getElementById('security-settings-modal').classList.add('active');
            loadUserSecurityData();
        }

        function closeSecuritySettings() {
            document.getElementById('security-settings-modal').classList.remove('active');
        }

        function loadUserSecurityData() {
            if (!currentUser) return;

            const loginHistoryContainer = document.getElementById('login-history');
            const userHistory = enhancedUserData.loginHistory
                .filter(log => log.email === currentUser.email)
                .slice(0, 10);

            loginHistoryContainer.innerHTML = userHistory.map(log => `
                <div class="login-history-item ${log.success ? 'success' : 'failed'}">
                    <div class="flex justify-between">
                        <div>
                            <p class="font-medium">${log.success ? 'Login Berhasil' : 'Login Gagal'}</p>
                            <p class="text-sm text-gray-600">${log.ip}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm">${formatDate(log.timestamp)}</p>
                            <p class="text-xs text-gray-500">${formatTime(log.timestamp)}</p>
                        </div>
                    </div>
                </div>
            `).join('');

            const sessionsContainer = document.getElementById('active-sessions-list');
            const userSessions = enhancedUserData.sessions.filter(s => s.email === currentUser.email);
            
            sessionsContainer.innerHTML = userSessions.map(session => `
                <div class="bg-gray-50 p-4 rounded-lg mb-2">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="font-medium">Sesi Aktif</p>
                            <p class="text-sm text-gray-600">Login: ${formatDateTime(session.loginTime)}</p>
                            <p class="text-xs text-gray-500">${session.ip}</p>
                        </div>
                        ${session.sessionId === currentUser.sessionId ? 
                            '<span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">Sesi Ini</span>' :
                            '<button onclick="logoutSession(\'' + session.sessionId + '\')" class="text-red-600 hover:text-red-800 text-sm">Logout</button>'
                        }
                    </div>
                </div>
            `).join('');
        }

        function changePassword() {
            const currentPass = document.getElementById('current-password').value;
            const newPass = document.getElementById('new-password').value;
            const confirmPass = document.getElementById('confirm-password').value;

            if (!currentPass || !newPass || !confirmPass) {
                showToast('Harap isi semua field password', 'error');
                return;
            }

            if (newPass !== confirmPass) {
                showToast('Password baru tidak cocok', 'error');
                return;
            }

            if (newPass.length < 8) {
                showToast('Password minimal 8 karakter', 'error');
                return;
            }

            showLoading();
            setTimeout(() => {
                hideLoading();
                showToast('Password berhasil diubah', 'success');
                addSecurityEvent('PASSWORD_CHANGED', `Password diubah untuk ${currentUser.email}`);
                document.getElementById('current-password').value = '';
                document.getElementById('new-password').value = '';
                document.getElementById('confirm-password').value = '';
            }, 1500);
        }

        function logoutSession(sessionId) {
            enhancedUserData.sessions = enhancedUserData.sessions.filter(s => s.sessionId !== sessionId);
            loadUserSecurityData();
            showToast('Sesi telah logout', 'success');
            addSecurityEvent('SESSION_REVOKED', `Sesi direvoke untuk ${currentUser.email}`);
        }

        function logoutOtherSessions() {
            enhancedUserData.sessions = enhancedUserData.sessions.filter(
                s => s.sessionId === currentUser.sessionId
            );
            loadUserSecurityData();
            showToast('Semua sesi lain telah logout', 'success');
            addSecurityEvent('ALL_SESSIONS_REVOKED', `Semua sesi lain direvoke untuk ${currentUser.email}`);
        }

        // ===== ABSENSI & KEHADIRAN FUNCTIONS =====
        function initAttendanceSystem() {
            // Initialize sample data
            if (!localStorage.getItem('attendanceData')) {
                generateSampleAttendanceData();
            } else {
                Object.assign(attendanceData, JSON.parse(localStorage.getItem('attendanceData')));
            }
            
            // Initialize WebSocket connection
            initWebSocket();
            
            // Load notifications
            loadNotifications();
            
            // Load attendance report
            loadAttendanceReport();
            
            // Generate today's QR code
            generateDailyQRCode();
        }

        function generateSampleAttendanceData() {
            // Sample attendance records for this month
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            attendanceData.students = platformData.siswa.map(siswa => ({
                id: siswa.id,
                name: siswa.nama,
                class: siswa.ruang,
                parentPhone: '08123456789',
                parentEmail: siswa.email.replace('@smpislamibadurrahman.id', '@gmail.com')
            }));
            
            // Generate attendance records for current month
            attendanceData.attendanceRecords = [];
            
            attendanceData.students.forEach(student => {
                for (let day = 1; day <= today.getDate(); day++) {
                    const date = new Date(currentYear, currentMonth, day);
                    if (date.getDay() !== 0 && date.getDay() !== 6) { // Skip weekends
                        const status = getRandomAttendanceStatus(date);
                        attendanceData.attendanceRecords.push({
                            studentId: student.id,
                            date: date.toISOString().split('T')[0],
                            time: status === 'present' ? '07:00' : status === 'late' ? '07:' + (15 + Math.floor(Math.random() * 30)) : null,
                            status: status,
                            scannedBy: status !== 'absent' ? 'QR_CODE' : null
                        });
                    }
                }
            });
            
            saveAttendanceData();
        }

        function getRandomAttendanceStatus(date) {
            const today = new Date();
            const rand = Math.random();
            if (date.getDate() === today.getDate()) {
                return 'present'; // Today's default
            }
            if (rand < 0.8) return 'present'; // 80% present
            if (rand < 0.9) return 'late';    // 10% late
            return 'absent';                  // 10% absent
        }

        // ===== QR CODE SCANNER FUNCTIONS =====
        function showQRScanner() {
            document.getElementById('qr-scanner-modal').classList.add('active');
            
            // Update today's QR code
            const today = new Date().toISOString().split('T')[0];
            const qrCode = attendanceData.qrCodes[today] || generateQRCodeForDate(today);
            document.getElementById('todays-qr-code').textContent = qrCode;
        }

        function closeQRScanner() {
            document.getElementById('qr-scanner-modal').classList.remove('active');
        }

        function generateDailyQRCode() {
            const today = new Date().toISOString().split('T')[0];
            if (!attendanceData.qrCodes[today]) {
                attendanceData.qrCodes[today] = generateQRCodeForDate(today);
                saveAttendanceData();
            }
        }

        function generateQRCodeForDate(date) {
            const classes = ['7A', '7B', '8A', '8B', '9A', '9B'];
            const randomClass = classes[Math.floor(Math.random() * classes.length)];
            return `ABSN-${date.replace(/-/g, '')}-${randomClass}`;
        }

        function simulateQRScan() {
            const qrCode = document.getElementById('todays-qr-code').textContent;
            processQRScan(qrCode);
        }

        function processQRScan(qrCode) {
            // Simulate scanning process
            showLoading();
            
            setTimeout(() => {
                const student = attendanceData.students[Math.floor(Math.random() * attendanceData.students.length)];
                const now = new Date();
                const timeString = now.getHours().toString().padStart(2, '0') + ':' + 
                                now.getMinutes().toString().padStart(2, '0');
                
                const status = now.getHours() > 7 || (now.getHours() === 7 && now.getMinutes() > 15) ? 'late' : 'present';
                
                // Record attendance
                const today = new Date().toISOString().split('T')[0];
                attendanceData.attendanceRecords.push({
                    studentId: student.id,
                    date: today,
                    time: timeString,
                    status: status,
                    scannedBy: 'QR_CODE',
                    qrCode: qrCode
                });
                
                saveAttendanceData();
                
                // Update UI
                document.getElementById('student-name').textContent = student.name;
                document.getElementById('attendance-time').textContent = timeString;
                document.getElementById('attendance-result').classList.remove('hidden');
                
                // Send notification if late
                if (status === 'late') {
                    sendLateNotification(student);
                }
                
                hideLoading();
                showToast(`Absensi berhasil! ${student.name} - ${status === 'late' ? 'Terlambat' : 'Hadir'}`, 'success');
                
                // Update attendance report
                loadAttendanceReport();
                
            }, 1500);
        }

        // ===== ATTENDANCE REPORT FUNCTIONS =====
        function loadAttendanceReport() {
            const today = new Date().toISOString().split('T')[0];
            const tableBody = document.getElementById('attendance-table');
            
            if (!tableBody) return;
            
            let presentToday = 0;
            let lateToday = 0;
            let absentToday = 0;
            let totalPresent = 0;
            let totalLate = 0;
            let totalAbsent = 0;
            let totalRecords = 0;
            
            const rows = attendanceData.students.map(student => {
                // Calculate statistics
                const studentRecords = attendanceData.attendanceRecords.filter(
                    record => record.studentId === student.id
                );
                
                const presentCount = studentRecords.filter(r => r.status === 'present').length;
                const lateCount = studentRecords.filter(r => r.status === 'late').length;
                const absentCount = studentRecords.filter(r => r.status === 'absent').length;
                
                totalPresent += presentCount;
                totalLate += lateCount;
                totalAbsent += absentCount;
                totalRecords += studentRecords.length;
                
                // Today's status
                const todayRecord = studentRecords.find(r => r.date === today);
                let todayStatus = 'Belum absen';
                let statusClass = 'attendance-absent';
                
                if (todayRecord) {
                    if (todayRecord.status === 'present') {
                        todayStatus = 'Hadir';
                        statusClass = 'attendance-present';
                        presentToday++;
                    } else if (todayRecord.status === 'late') {
                        todayStatus = `Terlambat (${todayRecord.time})`;
                        statusClass = 'attendance-late';
                        lateToday++;
                    } else {
                        todayStatus = 'Tidak hadir';
                        absentToday++;
                    }
                } else {
                    absentToday++;
                }
                
                const attendanceRate = studentRecords.length > 0 ? 
                    Math.round(((presentCount + lateCount) / studentRecords.length) * 100) : 0;
                
                return `
                    <tr>
                        <td class="font-mono">${student.id}</td>
                        <td class="font-medium">${student.name}</td>
                        <td>${student.class}</td>
                        <td>${presentCount}</td>
                        <td>${lateCount}</td>
                        <td>${absentCount}</td>
                        <td>
                            <div class="flex items-center">
                                <div class="w-full bg-gray-200 rounded-full h-2.5 mr-2">
                                    <div class="bg-green-600 h-2.5 rounded-full" style="width: ${attendanceRate}%"></div>
                                </div>
                                <span>${attendanceRate}%</span>
                            </div>
                        </td>
                        <td><span class="${statusClass} attendance-status">${todayStatus}</span></td>
                    </tr>
                `;
            }).join('');
            
            tableBody.innerHTML = rows;
            
            // Update statistics
            document.getElementById('total-present').textContent = presentToday;
            document.getElementById('total-late').textContent = lateToday;
            document.getElementById('total-absent').textContent = absentToday;
            
            const totalAttendanceRate = totalRecords > 0 ? 
                Math.round(((totalPresent + totalLate) / totalRecords) * 100) : 0;
            document.getElementById('attendance-rate').textContent = `${totalAttendanceRate}%`;
        }

        function filterAttendance() {
            const filter = document.getElementById('attendance-filter').value;
            loadAttendanceReport(); // In real implementation, filter would be applied
        }

        function exportAttendanceReport() {
            showLoading();
            setTimeout(() => {
                hideLoading();
                showToast('Laporan kehadiran berhasil diexport!', 'success');
                
                // Create CSV content
                let csvContent = "data:text/csv;charset=utf-8,";
                csvContent += "NIS,Nama,Kelas,Hadir,Terlambat,Tidak Hadir,Persentase,Status Hari Ini\n";
                
                attendanceData.students.forEach(student => {
                    const records = attendanceData.attendanceRecords.filter(r => r.studentId === student.id);
                    const presentCount = records.filter(r => r.status === 'present').length;
                    const lateCount = records.filter(r => r.status === 'late').length;
                    const absentCount = records.filter(r => r.status === 'absent').length;
                    const total = records.length;
                    const rate = total > 0 ? Math.round(((presentCount + lateCount) / total) * 100) : 0;
                    
                    const today = new Date().toISOString().split('T')[0];
                    const todayRecord = records.find(r => r.date === today);
                    const todayStatus = todayRecord ? 
                        (todayRecord.status === 'present' ? 'Hadir' : 
                         todayRecord.status === 'late' ? 'Terlambat' : 'Tidak Hadir') : 'Belum absen';
                    
                    csvContent += `${student.id},${student.name},${student.class},${presentCount},${lateCount},${absentCount},${rate}%,${todayStatus}\n`;
                });
                
                // Download CSV
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `laporan_kehadiran_${new Date().toISOString().split('T')[0]}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }, 1000);
        }

        // ===== NOTIFICATION SYSTEM FUNCTIONS =====
        function initWebSocket() {
            // Simulate WebSocket connection
            isConnected = true;
            updateConnectionStatus();
            
            // Simulate receiving notifications
            setInterval(() => {
                if (isConnected && Math.random() > 0.7) {
                    receiveSimulatedNotification();
                }
            }, 30000); // Every 30 seconds
        }

        function updateConnectionStatus() {
            const statusElement = document.getElementById('connection-status');
            if (statusElement) {
                statusElement.className = `connection-status connection-${isConnected ? 'connected' : 'disconnected'}`;
                statusElement.innerHTML = `<i class="fas fa-circle text-xs mr-2"></i>${isConnected ? 'Connected' : 'Disconnected'}`;
            }
        }

        function toggleNotifications() {
            const dropdown = document.getElementById('notification-dropdown');
            dropdown.classList.toggle('active');
            
            if (dropdown.classList.contains('active')) {
                loadNotifications();
            }
        }

        function loadNotifications() {
            const container = document.getElementById('notification-list');
            if (!container) return;
            
            // Sample notifications
            const notifications = [
                {
                    id: 1,
                    type: 'payment',
                    title: 'Pengingat Pembayaran SPP',
                    message: 'SPP bulan Maret jatuh tempo pada 10 Maret 2024',
                    time: '2 jam yang lalu',
                    read: false
                },
                {
                    id: 2,
                    type: 'attendance',
                    title: 'Ketidakhadiran Siswa',
                    message: 'Ahmad Fauzi tidak hadir hari ini',
                    time: '4 jam yang lalu',
                    read: false
                },
                {
                    id: 3,
                    type: 'grade',
                    title: 'Nilai Ujian Matematika',
                    message: 'Nilai ujian Matematika telah diumumkan',
                    time: '1 hari yang lalu',
                    read: true
                },
                {
                    id: 4,
                    type: 'task',
                    title: 'Deadline Tugas IPA',
                    message: 'Tugas IPA deadline besok',
                    time: '2 hari yang lalu',
                    read: true
                },
                {
                    id: 5,
                    type: 'event',
                    title: 'Kegiatan Class Meeting',
                    message: 'Class meeting akan dilaksanakan minggu depan',
                    time: '3 hari yang lalu',
                    read: true
                }
            ];
            
            container.innerHTML = notifications.map(notif => `
                <div class="notification-item ${notif.read ? '' : 'unread'}" onclick="viewNotification(${notif.id})">
                    <div class="flex items-start">
                        <div class="notification-icon ${notif.type}">
                            <i class="fas fa-${notif.type === 'payment' ? 'credit-card' : 
                                         notif.type === 'attendance' ? 'user-clock' : 
                                         notif.type === 'grade' ? 'graduation-cap' : 
                                         notif.type === 'task' ? 'tasks' : 'calendar-alt'}"></i>
                        </div>
                        <div class="flex-1">
                            <div class="flex justify-between">
                                <h5 class="font-semibold text-gray-800">${notif.title}</h5>
                                <span class="text-xs text-gray-500">${notif.time}</span>
                            </div>
                            <p class="text-sm text-gray-600 mt-1">${notif.message}</p>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Update notification badge
            const unreadCount = notifications.filter(n => !n.read).length;
            const badge = document.querySelector('.notification-badge');
            if (badge) {
                badge.textContent = unreadCount;
                badge.style.display = unreadCount > 0 ? 'flex' : 'none';
            }
        }

        function viewNotification(id) {
            // Mark as read
            const notification = notificationSystem.notifications.find(n => n.id === id);
            if (notification && !notification.read) {
                notification.read = true;
                saveNotificationData();
                loadNotifications();
            }
            
            // Show notification details
            showToast('Membuka notifikasi...', 'info');
        }

        function markAllAsRead() {
            notificationSystem.notifications.forEach(notif => notif.read = true);
            saveNotificationData();
            loadNotifications();
            showToast('Semua notifikasi ditandai sudah dibaca', 'success');
        }

        function sendNotification(type, data) {
            const template = notificationSystem.templates[type];
            if (!template) return;
            
            const content = typeof template.content === 'function' ? 
                template.content(...Object.values(data)) : template.content;
            
            // Add to notifications
            const newNotification = {
                id: Date.now(),
                type: type,
                title: template.subject,
                message: content.replace(/<[^>]*>/g, '').substring(0, 100) + '...',
                time: 'Baru saja',
                read: false,
                data: data
            };
            
            notificationSystem.notifications.unshift(newNotification);
            
            // Limit notifications
            if (notificationSystem.notifications.length > 50) {
                notificationSystem.notifications.pop();
            }
            
            // Send via enabled methods
            if (attendanceData.notificationSettings.email) {
                sendEmailNotification(template.subject, content, data.parentEmail);
            }
            
            if (attendanceData.notificationSettings.whatsapp) {
                sendWhatsAppNotification(template.subject, content, data.parentPhone);
            }
            
            if (attendanceData.notificationSettings.sms) {
                sendSMSNotification(template.subject, content, data.parentPhone);
            }
            
            saveNotificationData();
            loadNotifications();
            
            // Show notification
            showDesktopNotification(template.subject, content);
        }

        function sendLateNotification(student) {
            if (!attendanceData.notificationSettings.late) return;
            
            const now = new Date();
            const timeString = now.getHours().toString().padStart(2, '0') + ':' + 
                            now.getMinutes().toString().padStart(2, '0');
            
            sendNotification('late', {
                studentName: student.name,
                time: timeString,
                parentPhone: student.parentPhone,
                parentEmail: student.parentEmail
            });
        }

        function sendEmailNotification(subject, content, toEmail) {
            // Simulate email sending
            console.log(`Email sent to ${toEmail}: ${subject}`);
            
            // In production, this would integrate with email service like SendGrid, Mailgun, etc.
            // Example: fetch('/api/send-email', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ to: toEmail, subject, content }) })
        }

        function sendWhatsAppNotification(subject, content, phoneNumber) {
            // Simulate WhatsApp sending
            console.log(`WhatsApp sent to ${phoneNumber}: ${subject}`);
            
            // In production, this would integrate with WhatsApp Business API
            const message = `${subject}\n\n${content.replace(/<[^>]*>/g, '')}`;
            const url = `https://api.whatsapp.com/send?phone=${phoneNumber}&text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
        }

        function sendSMSNotification(subject, content, phoneNumber) {
            // Simulate SMS sending
            console.log(`SMS sent to ${phoneNumber}: ${subject}`);
        }

        function showDesktopNotification(title, body) {
            if ("Notification" in window && Notification.permission === "granted") {
                new Notification(title, { body, icon: 'https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg' });
            }
        }

        // ===== NOTIFICATION SETTINGS =====
        function showNotificationSettings() {
            // Settings already visible in the section
            document.getElementById('absensi').scrollIntoView({ behavior: 'smooth' });
        }

        function saveNotificationSettings() {
            attendanceData.notificationSettings.absence = document.getElementById('notif-absence').checked;
            attendanceData.notificationSettings.late = document.getElementById('notif-late').checked;
            attendanceData.notificationSettings.weekly = document.getElementById('notif-weekly').checked;
            attendanceData.notificationSettings.whatsapp = document.getElementById('method-whatsapp').checked;
            attendanceData.notificationSettings.email = document.getElementById('method-email').checked;
            attendanceData.notificationSettings.sms = document.getElementById('method-sms').checked;
            
            saveAttendanceData();
            showToast('Pengaturan notifikasi disimpan', 'success');
        }

        function sendTestNotification() {
            const student = attendanceData.students[0];
            sendNotification('absence', {
                studentName: student.name,
                date: new Date().toLocaleDateString('id-ID'),
                parentPhone: student.parentPhone,
                parentEmail: student.parentEmail
            });
            showToast('Notifikasi test dikirim', 'success');
        }

        // ===== EMAIL PREVIEW =====
        function previewEmail(type) {
            const template = notificationSystem.templates[type];
            if (!template) return;
            
            document.getElementById('email-subject').textContent = template.subject;
            document.getElementById('email-content').innerHTML = 
                typeof template.content === 'function' ? 
                template.content('Ahmad Fauzi', '15 Maret 2024', 'Rp 350.000') : 
                template.content;
            
            document.getElementById('email-preview-modal').classList.add('active');
        }

        function closeEmailPreview() {
            document.getElementById('email-preview-modal').classList.remove('active');
        }

        // ===== DATA PERSISTENCE =====
        function savePlatformData() { 
            platformData.marketplaceData.cart = shoppingCart; 
            localStorage.setItem('platformData', JSON.stringify(platformData)); 
        }

        function saveSecurityData() {
            localStorage.setItem('securityConfig', JSON.stringify(securityConfig));
            localStorage.setItem('enhancedUserData', JSON.stringify(enhancedUserData));
        }

        function saveAttendanceData() {
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
        }

        function saveNotificationData() {
            localStorage.setItem('notificationSystem', JSON.stringify(notificationSystem));
        }

        function loadPlatformData() {
            const saved = localStorage.getItem('platformData');
            if (saved) { 
                try { 
                    const parsedData = JSON.parse(saved); 
                    platformData = { ...platformData, ...parsedData }; 
                } catch (e) { 
                    console.error('Error loading platform data:', e); 
                } 
            } 
            else { 
                initializeDefaultData(); 
                savePlatformData(); 
            }
            updatePPDBCounter(); 
            loadMarketplaceProducts(); 
            loadSPPHistory(); 
            loadTabunganHistory();
        }

        function loadSecurityData() {
            const savedConfig = localStorage.getItem('securityConfig');
            const savedData = localStorage.getItem('enhancedUserData');
            
            if (savedConfig) {
                Object.assign(securityConfig, JSON.parse(savedConfig));
            }
            
            if (savedData) {
                Object.assign(enhancedUserData, JSON.parse(savedData));
            }
        }

        function initializeDefaultData() {
            platformData.siswa.forEach(siswa => {
                if (!platformData.userProgress[siswa.email]) { 
                    platformData.userProgress[siswa.email] = { 
                        completedMateri: [], 
                        completedGames: [], 
                        completedTugas: [], 
                        lastLogin: new Date().toISOString() 
                    }; 
                }
                if (!platformData.userPoints[siswa.email]) { 
                    platformData.userPoints[siswa.email] = Math.floor(Math.random() * 500) + 100; 
                }
                if (!platformData.sppData.students[siswa.id]) { 
                    platformData.sppData.students[siswa.id] = { 
                        nama: siswa.nama, 
                        kelas: siswa.ruang, 
                        sppHistory: [] 
                    }; 
                }
            });
            if (platformData.tugas.length === 0) { 
                platformData.tugas = [{ 
                    id: '1', 
                    judul: 'Tugas Aljabar', 
                    mapel: 'Matematika', 
                    deskripsi: 'Kerjakan soal-soal tentang pengenalan bentuk aljabar', 
                    deadline: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], 
                    pembuat: 'Ustadz Surahman, S.Pd', 
                    tanggal: new Date().toISOString(), 
                    poin: 100, 
                    level: 'Kelas 7' 
                }]; 
            }
            if (platformData.ppdbData.applications.length === 0) { 
                platformData.ppdbData.applications = [{ 
                    id: 'PPDB-2024-0001', 
                    nama: 'Ahmad Fauzi', 
                    tanggalLahir: '2012-03-15', 
                    asalSekolah: 'SD Negeri 1 Batu', 
                    tanggalDaftar: '2024-01-15', 
                    status: 'menunggu' 
                }]; 
            }
            shoppingCart = platformData.marketplaceData.cart || [];
        }

        // ===== KEEP ALL EXISTING PPDB FUNCTIONS =====
        function updatePPDBCounter() {
            const today = new Date(); 
            const endDate = new Date(platformData.ppdbData.endDate); 
            const timeDiff = endDate.getTime() - today.getTime(); 
            const daysLeft = Math.ceil(timeDiff / (1000 * 3600 * 24));
            document.getElementById('ppdb-days-left').textContent = daysLeft > 0 ? daysLeft : 0;
            document.getElementById('ppdb-quota-left').textContent = platformData.ppdbData.quota - platformData.ppdbData.registered;
            document.getElementById('ppdb-registered').textContent = platformData.ppdbData.registered;
        }

        // ===== KEEP ALL EXISTING SPP FUNCTIONS =====
        function loadSPPHistory() {
            const historyContainer = document.getElementById('spp-history');
            if (!historyContainer) return;
            const sampleHistory = [
                { bulan: 'Januari 2024', jumlah: 'Rp 350.000', status: 'Lunas', tanggal: '05 Jan 2024' },
                { bulan: 'Desember 2023', jumlah: 'Rp 350.000', status: 'Lunas', tanggal: '03 Des 2023' },
                { bulan: 'November 2023', jumlah: 'Rp 350.000', status: 'Lunas', tanggal: '07 Nov 2023' },
                { bulan: 'Oktober 2023', jumlah: 'Rp 350.000', status: 'Lunas', tanggal: '05 Okt 2023' }
            ];
            historyContainer.innerHTML = sampleHistory.map(item => `<tr><td>${item.bulan}</td><td>${item.jumlah}</td><td><span class="payment-badge paid">${item.status}</span></td><td>${item.tanggal}</td></tr>`).join('');
        }

        // ===== KEEP ALL EXISTING MARKETPLACE FUNCTIONS =====
        function loadMarketplaceProducts() {
            const container = document.getElementById('marketplace-products'); 
            if (!container) return;
            container.innerHTML = platformData.marketplaceData.products.map(product => `
                <div class="product-card" data-category="${product.category}">
                    <div class="relative h-56 bg-gradient-to-r from-${product.category === 'seragam' ? 'blue' : product.category === 'buku' ? 'green' : product.category === 'makanan' ? 'yellow' : 'purple'}-100 to-${product.category === 'seragam' ? 'blue' : product.category === 'buku' ? 'green' : product.category === 'makanan' ? 'yellow' : 'purple'}-200">
                        <div class="absolute inset-0 flex items-center justify-center"><i class="fas fa-${product.id === 'P001' ? 'tshirt' : product.id === 'P002' ? 'running' : product.id === 'P003' ? 'book' : product.id === 'P004' ? 'pencil-alt' : product.id === 'P005' ? 'cookie-bite' : product.id === 'P006' ? 'glass-whiskey' : product.id === 'P007' ? 'briefcase' : 'pray'} text-${product.category === 'seragam' ? 'blue' : product.category === 'buku' ? 'green' : product.category === 'makanan' ? 'yellow' : 'purple'}-600 text-5xl"></i></div>
                        ${product.discount > 0 ? `<div class="product-discount">${product.discount}% OFF</div>` : ''}
                    </div>
                    <div class="p-6"><h3 class="text-lg font-semibold text-gray-800 mb-2">${product.name}</h3><p class="text-gray-600 text-sm mb-4">${product.description}</p>
                    <div class="flex items-center justify-between mb-4"><div>${product.discount > 0 ? `<div class="flex items-center"><span class="text-xl font-bold text-gray-800">Rp ${(product.price * (100 - product.discount) / 100).toLocaleString()}</span><span class="text-sm text-gray-500 line-through ml-2">Rp ${product.price.toLocaleString()}</span></div>` : `<span class="text-xl font-bold text-gray-800">Rp ${product.price.toLocaleString()}</span>`}</div><span class="text-sm text-gray-500">Stok: ${product.stock}</span></div>
                    <button onclick="addToCart('${product.id}')" class="w-full interactive-btn bg-gradient-to-r from-purple-500 to-purple-600"><i class="fas fa-cart-plus mr-2"></i>Tambah ke Keranjang</button></div>
                </div>`).join('');
            updateCartDisplay();
        }

        // ===== KEEP ALL EXISTING AUTH FUNCTIONS =====
        function showLoginForm(role) {
            document.getElementById('login-options').classList.add('hidden'); 
            document.getElementById('login-form').classList.remove('hidden');
            const emailField = document.getElementById('login-email'); 
            const roleField = document.getElementById('login-role'); 
            const demoEmail = document.getElementById('demo-email'); 
            const roleTitle = document.getElementById('login-role-title');
            roleField.value = role; 
            roleTitle.textContent = `Masuk sebagai ${role === 'admin' ? 'Admin' : role === 'guru' ? 'Guru' : 'Santri'}`;
            if (role === 'admin') { 
                emailField.value = 'admin@smpislamibadurrahman.id'; 
                demoEmail.textContent = 'admin@smpislamibadurrahman.id'; 
            } 
            else if (role === 'guru') { 
                const firstGuru = platformData.guru[0]; 
                emailField.value = firstGuru ? firstGuru.email : 'guru@smpislamibadurrahman.id'; 
                demoEmail.textContent = firstGuru ? firstGuru.email : 'guru@smpislamibadurrahman.id'; 
            } 
            else { 
                const firstSiswa = platformData.siswa[0]; 
                emailField.value = firstSiswa ? firstSiswa.email : 'santri@smpislamibadurrahman.id'; 
                demoEmail.textContent = firstSiswa ? firstSiswa.email : 'santri@smpislamibadurrahman.id'; 
            }
            document.getElementById('login-password').value = '';
        }

        function showLoginOptions() { 
            document.getElementById('login-form').classList.add('hidden'); 
            document.getElementById('login-options').classList.remove('hidden'); 
        }

        function getInitials(name) { 
            return name.split(' ').map(word => word[0]).join('').toUpperCase().substring(0, 2); 
        }

        function updateDashboardUI() {
            if (!currentUser) return; 
            document.getElementById('dashboard-username').textContent = currentUser.name; 
            document.getElementById('dashboard-role').textContent = currentUser.role.toUpperCase();
            document.getElementById('dashboard-class').textContent = currentUser.kelas ? `Kelas ${currentUser.kelas}` : ''; 
            document.getElementById('dashboard-avatar').src = 'https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg';
            const points = platformData.userPoints[currentUser.email] || 0; 
            document.getElementById('user-points').textContent = points; 
            document.getElementById('poin-count').textContent = points;
            const adminBtn = document.getElementById('admin-panel-btn'); 
            if (currentUser.role === 'admin' || currentUser.role === 'guru') { 
                adminBtn.classList.remove('hidden'); 
                adminBtn.onclick = function() {
                    document.getElementById('enhanced-admin-panel').classList.toggle('hidden');
                    if (!document.getElementById('enhanced-admin-panel').classList.contains('hidden')) {
                        loadAdminDashboard();
                    }
                };
            } else { 
                adminBtn.classList.add('hidden'); 
            }
            loadDashboardData();
        }

        function updateMobileUserMenu() {
            const mobileMenu = document.getElementById('mobile-user-menu'); 
            const username = document.getElementById('mobile-username'); 
            const userRole = document.getElementById('mobile-user-role'); 
            const userInitials = document.getElementById('mobile-user-avatar');
            if (currentUser) { 
                mobileMenu.classList.remove('hidden'); 
                username.textContent = currentUser.name; 
                userRole.textContent = currentUser.role.toUpperCase(); 
                userInitials.src = 'https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg';
                const desktopMenu = document.getElementById('user-menu'); 
                const desktopUsername = document.getElementById('username'); 
                const desktopAvatar = document.getElementById('user-avatar');
                if (desktopMenu && desktopUsername) { 
                    desktopMenu.classList.remove('hidden'); 
                    desktopUsername.textContent = currentUser.name; 
                    desktopAvatar.src = 'https://i.ibb.co.com/vNTTNz8/Logo-SMP-Islam-Ibadurraham-temas.jpg'; 
                } 
            }
        }

        // ===== KEEP ALL EXISTING DASHBOARD FUNCTIONS =====
        function loadDashboardData() {
            if (!currentUser) return; 
            const userProgress = platformData.userProgress[currentUser.email] || { completedMateri: [], completedGames: [], completedTugas: [] };
            document.getElementById('materi-count').textContent = userProgress.completedMateri.length; 
            document.getElementById('tugas-count').textContent = userProgress.completedTugas.length; 
            document.getElementById('game-count').textContent = userProgress.completedGames.length;
            const totalMateri = platformData.materi.length; 
            const completedMateri = userProgress.completedMateri.length; 
            const progress = totalMateri > 0 ? Math.round((completedMateri / totalMateri) * 100) : 0;
            document.getElementById('progress-percentage').textContent = `${progress}%`; 
            document.getElementById('progress-text').textContent = `Menyelesaikan ${completedMateri} dari ${totalMateri} modul`;
            updateProgressRing(progress); 
            loadRecentActivities();
        }

        function updateProgressRing(progress) {
            const circle = document.querySelector('.progress-ring-circle'); 
            if (circle) { 
                const radius = circle.r.baseVal.value; 
                const circumference = radius * 2 * Math.PI; 
                const offset = circumference - (progress / 100) * circumference; 
                circle.style.strokeDasharray = `${circumference} ${circumference}`; 
                circle.style.strokeDashoffset = offset; 
            }
        }

        function loadRecentActivities() {
            const container = document.getElementById('recent-activities'); 
            if (!container) return;
            const activities = [
                { icon: 'book', color: 'blue', title: 'Mempelajari Aljabar Dasar', time: '5 menit yang lalu' },
                { icon: 'gamepad', color: 'purple', title: 'Menyelesaikan Game Matematika', time: '1 jam yang lalu' },
                { icon: 'tasks', color: 'green', title: 'Mengumpulkan Tugas IPA', time: '2 jam yang lalu' }
            ];
            container.innerHTML = activities.map(activity => `<div class="flex items-center p-4 bg-${activity.color}-50 rounded-xl hover:bg-${activity.color}-100 transition-colors cursor-pointer"><div class="bg-${activity.color}-100 p-3 rounded-lg mr-4"><i class="fas fa-${activity.icon} text-${activity.color}-600"></i></div><div class="flex-1"><p class="font-medium text-gray-800">${activity.title}</p><p class="text-sm text-gray-600">${activity.time}</p></div><i class="fas fa-chevron-right text-gray-400"></i></div>`).join('');
        }

        function showPlatformSection(section) {
            document.querySelectorAll('.platform-section').forEach(sec => { sec.classList.remove('active'); });
            document.querySelectorAll('.dashboard-nav').forEach(btn => { btn.classList.remove('active'); });
            document.getElementById(`${section}-content`).classList.add('active'); 
            event.target.classList.add('active');
            document.querySelector('#platform-dashboard').scrollIntoView({ behavior: 'smooth' });
        }

        // ===== HELPER FUNCTIONS =====
        function showForgotPassword() {
            const email = prompt('Masukkan email Anda untuk reset password:');
            if (email) {
                showLoading();
                setTimeout(() => {
                    hideLoading();
                    showToast('Instruksi reset password telah dikirim ke email Anda', 'success');
                    addSecurityEvent('PASSWORD_RESET_REQUESTED', `Reset password diminta untuk ${email}`);
                }, 1000);
            }
        }

        function downloadSecurityReport() {
            showLoading();
            setTimeout(() => {
                hideLoading();
                showToast('Laporan keamanan berhasil diunduh', 'success');
                addSecurityEvent('SECURITY_REPORT_DOWNLOADED', 'Laporan keamanan diunduh');
                
                const data = {
                    securityEvents: enhancedUserData.securityEvents,
                    auditLogs: enhancedUserData.auditLogs,
                    loginHistory: enhancedUserData.loginHistory,
                    generatedAt: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `security-report-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 1500);
        }

        // ===== SCHEDULED NOTIFICATIONS =====
        function scheduleDailyNotifications() {
            // Check for absent students and send notifications
            const today = new Date().toISOString().split('T')[0];
            const absentStudents = [];
            
            attendanceData.students.forEach(student => {
                const todayRecord = attendanceData.attendanceRecords.find(
                    r => r.studentId === student.id && r.date === today
                );
                
                if (!todayRecord || todayRecord.status === 'absent') {
                    absentStudents.push(student);
                }
            });
            
            // Send notifications for absent students
            if (absentStudents.length > 0 && attendanceData.notificationSettings.absence) {
                absentStudents.forEach(student => {
                    sendNotification('absence', {
                        studentName: student.name,
                        date: new Date().toLocaleDateString('id-ID'),
                        parentPhone: student.parentPhone,
                        parentEmail: student.parentEmail
                    });
                });
            }
            
            // Weekly report on Fridays
            if (new Date().getDay() === 5) { // Friday
                sendWeeklyReport();
            }
            
            // SPP reminder on 5th of each month
            if (new Date().getDate() === 5) {
                sendSPPReminder();
            }
        }

        function sendWeeklyReport() {
            if (!attendanceData.notificationSettings.weekly) return;
            
            // Generate weekly report for each student
            attendanceData.students.forEach(student => {
                const weekRecords = attendanceData.attendanceRecords.filter(r => 
                    r.studentId === student.id && 
                    isDateInThisWeek(new Date(r.date))
                );
                
                const presentCount = weekRecords.filter(r => r.status === 'present').length;
                const lateCount = weekRecords.filter(r => r.status === 'late').length;
                const absentCount = weekRecords.filter(r => r.status === 'absent').length;
                
                const content = `
                    <p>Kepada Yth. Orang Tua/Wali dari <strong>${student.name}</strong>,</p>
                    <p>Berikut laporan kehadiran mingguan:</p>
                    <ul>
                        <li>Hadir tepat waktu: ${presentCount} hari</li>
                        <li>Terlambat: ${lateCount} hari</li>
                        <li>Tidak hadir: ${absentCount} hari</li>
                    </ul>
                    <p>Terima kasih atas perhatiannya.</p>
                `;
                
                sendEmailNotification('Laporan Kehadiran Mingguan', content, student.parentEmail);
            });
        }

        function sendSPPReminder() {
            const nextMonth = new Date();
            nextMonth.setMonth(nextMonth.getMonth() + 1);
            const monthName = nextMonth.toLocaleDateString('id-ID', { month: 'long' });
            
            attendanceData.students.forEach(student => {
                sendNotification('spp', {
                    month: monthName,
                    dueDate: '10 ' + monthName + ' ' + nextMonth.getFullYear(),
                    amount: 'Rp 350.000',
                    parentPhone: student.parentPhone,
                    parentEmail: student.parentEmail
                });
            });
        }

        function isDateInThisWeek(date) {
            const today = new Date();
            const firstDayOfWeek = new Date(today.setDate(today.getDate() - today.getDay()));
            const lastDayOfWeek = new Date(firstDayOfWeek);
            lastDayOfWeek.setDate(lastDayOfWeek.getDate() + 6);
            
            return date >= firstDayOfWeek && date <= lastDayOfWeek;
        }

        // ===== SIMULATE RECEIVING NOTIFICATION =====
        function receiveSimulatedNotification() {
            const types = ['payment', 'grade', 'event', 'task'];
            const type = types[Math.floor(Math.random() * types.length)];
            
            const students = ['Ahmad Fauzi', 'Siti Nurhaliza', 'Budi Santoso', 'Dewi Lestari'];
            const student = students[Math.floor(Math.random() * students.length)];
            
            const data = {
                studentName: student,
                parentPhone: '08123456789',
                parentEmail: 'orangtua@gmail.com'
            };
            
            switch(type) {
                case 'payment':
                    data.month = 'Maret';
                    data.dueDate = '10 Maret 2024';
                    data.amount = 'Rp 350.000';
                    break;
                case 'grade':
                    data.subject = 'Matematika';
                    data.score = Math.floor(Math.random() * 30) + 70;
                    break;
                case 'event':
                    data.eventName = 'Class Meeting';
                    data.date = '20 Maret 2024';
                    data.time = '08:00 - 12:00 WIB';
                    break;
                case 'task':
                    data.taskName = 'Tugas IPA tentang Ekosistem';
                    data.deadline = '18 Maret 2024';
                    break;
            }
            
            sendNotification(type, data);
        }

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            loadPlatformData();
            loadSecurityData();
            
            // Initialize attendance system
            initAttendanceSystem();
            
            // Event listeners for existing forms
            document.getElementById('ppdb-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                const regNumber = `PPDB-2024-${(platformData.ppdbData.applications.length + 1).toString().padStart(4, '0')}`;
                document.getElementById('ppdb-registration-number').textContent = regNumber;
                const application = {
                    id: regNumber, 
                    nama: document.getElementById('ppdb-nama').value, 
                    tempatLahir: document.getElementById('ppdb-tempat-lahir').value,
                    tanggalLahir: document.getElementById('ppdb-tanggal-lahir').value, 
                    jenisKelamin: document.getElementById('ppdb-jenis-kelamin').value,
                    asalSekolah: document.getElementById('ppdb-asal-sekolah').value, 
                    alamat: document.getElementById('ppdb-alamat').value,
                    noHp: document.getElementById('ppdb-no-hp').value, 
                    email: document.getElementById('ppdb-email').value, 
                    jalur: document.getElementById('ppdb-jalur').value,
                    tanggalDaftar: new Date().toISOString().split('T')[0], 
                    status: 'pending'
                };
                platformData.ppdbData.applications.push(application); 
                platformData.ppdbData.registered++; 
                savePlatformData(); 
                updatePPDBCounter();
                showToast(`Pendaftaran berhasil! No. Pendaftaran: ${regNumber}. Silakan lanjutkan pembayaran.`, 'success');
                this.reset(); 
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            document.getElementById('spp-check-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                const nis = document.getElementById('spp-nis').value; 
                const bulan = document.getElementById('spp-bulan').value;
                if (!nis) { 
                    showToast('Mohon masukkan NIS siswa', 'error'); 
                    return; 
                }
                const siswa = platformData.siswa.find(s => s.id === nis);
                if (!siswa) { 
                    showToast('NIS tidak ditemukan', 'error'); 
                    return; 
                }
                document.getElementById('spp-nama-siswa').textContent = siswa.nama; 
                document.getElementById('spp-kelas').textContent = siswa.ruang;
                document.getElementById('spp-bulan-tagihan').textContent = bulan ? getMonthName(bulan) : 'Januari 2024';
                document.getElementById('spp-jatuh-tempo').textContent = '10 ' + (bulan ? getMonthName(bulan) : 'Januari 2024');
                document.getElementById('spp-total').textContent = 'Rp 350.000'; 
                document.getElementById('spp-result').classList.remove('hidden');
                document.getElementById('spp-pay-button').onclick = function() { 
                    showPaymentModal(siswa.nama, 'Rp 350.000', bulan ? getMonthName(bulan) : 'Januari 2024'); 
                };
            });

            document.getElementById('contact-form').addEventListener('submit', function(e) {
                e.preventDefault(); 
                const name = document.getElementById('name').value; 
                const email = document.getElementById('email').value; 
                const message = document.getElementById('message').value;
                if (!name || !email || !message) { 
                    showToast('Mohon lengkapi semua field!', 'error'); 
                    return; 
                }
                showLoading(); 
                setTimeout(() => { 
                    hideLoading(); 
                    showToast('Pesan Anda telah terkirim! Kami akan segera menghubungi Anda.', 'success'); 
                    this.reset(); 
                }, 1500);
            });

            // Mobile menu
            document.getElementById('mobile-menu-button').addEventListener('click', function() { 
                const mobileMenu = document.getElementById('mobile-menu'); 
                mobileMenu.classList.toggle('hidden'); 
            });

            // Smooth scrolling
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault(); 
                    const targetId = this.getAttribute('href'); 
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) { 
                        const mobileMenu = document.getElementById('mobile-menu'); 
                        mobileMenu.classList.add('hidden');
                        window.scrollTo({ top: targetElement.offsetTop - 80, behavior: 'smooth' }); 
                    }
                });
            });

            // Request notification permission
            if ("Notification" in window) {
                Notification.requestPermission();
            }
            
            // Add navigation link for absensi (already in HTML)
            
            // Welcome message
            setTimeout(() => { 
                if (!currentUser) { 
                    showToast('Selamat datang di SMP Islam Ibadurrahman Temas!', 'info', 3000); 
                } 
            }, 1000);
            
            // Start scheduled notifications
            setInterval(scheduleDailyNotifications, 24 * 60 * 60 * 1000); // Daily
            
            // Update connection status periodically
            setInterval(() => {
                // Simulate connection issues
                if (Math.random() < 0.1) { // 10% chance of disconnection
                    isConnected = false;
                    updateConnectionStatus();
                    
                    setTimeout(() => {
                        isConnected = true;
                        updateConnectionStatus();
                        showToast('Koneksi kembali normal', 'success');
                    }, 5000);
                }
            }, 60000); // Check every minute
            
            // Add idle timer
            let idleTimer;
            function resetIdleTimer() {
                clearTimeout(idleTimer);
                idleTimer = setTimeout(() => {
                    if (currentUser && document.visibilityState === 'visible') {
                        addSecurityEvent('SESSION_EXPIRED', `Sesi expired karena idle untuk ${currentUser.email}`);
                        logout();
                        showToast('Sesi berakhir karena tidak ada aktivitas', 'info');
                    }
                }, securityConfig.sessionTimeout);
            }

            document.addEventListener('mousemove', resetIdleTimer);
            document.addEventListener('keypress', resetIdleTimer);
            document.addEventListener('click', resetIdleTimer);
            resetIdleTimer();

            // Track user activity
            document.addEventListener('click', () => {
                if (currentUser) {
                    const session = enhancedUserData.sessions.find(s => s.sessionId === currentUser.sessionId);
                    if (session) {
                        session.lastActivity = new Date().toISOString();
                    }
                }
            });
        });

        // Window event listeners
        window.addEventListener('scroll', function() {
            const navbar = document.querySelector('.navbar-kemendikbud');
            if (window.scrollY > 50) { 
                navbar.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.1)'; 
            } else { 
                navbar.style.boxShadow = '0 2px 10px rgba(0,0,0,0.1)'; 
            }
        });

        // Helper function
        function getMonthName(monthNumber) {
            const months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
            return months[parseInt(monthNumber) - 1] + ' 2024';
        }

        // Placeholder functions for other features
        function closeAdminPanel() { 
            document.getElementById('admin-panel-modal').classList.remove('active'); 
        }
        function startGame(gameId) { 
            showToast('Fitur game akan segera hadir!', 'info'); 
        }
        function closeGame() { 
            document.getElementById('game-modal').classList.remove('active'); 
        }
        function startQuiz(quizType) { 
            showToast('Fitur quiz akan segera hadir!', 'info'); 
        }
        function closeQuiz() { 
            document.getElementById('quiz-modal').classList.remove('active'); 
        }
        function showPaymentModal(nama, jumlah, bulan) {
            document.getElementById('payment-modal').classList.add('active');
            document.getElementById('payment-content').innerHTML = `
                <div class="space-y-6">
                    <div class="bg-gray-50 p-6 rounded-xl"><h4 class="text-lg font-semibold text-gray-800 mb-4">Detail Pembayaran</h4><div class="space-y-3"><div class="flex justify-between"><span class="text-gray-600">Nama Siswa</span><span class="font-medium">${nama}</span></div><div class="flex justify-between"><span class="text-gray-600">Bulan Tagihan</span><span class="font-medium">${bulan}</span></div><div class="flex justify-between border-t border-gray-200 pt-3"><span class="text-gray-600 font-semibold">Total Pembayaran</span><span class="text-xl font-bold text-green-600">${jumlah}</span></div></div></div>
                    <div><h4 class="text-lg font-semibold text-gray-800 mb-4">Pilih Metode Pembayaran</h4><div class="grid grid-cols-2 gap-4">
                        <label class="relative"><input type="radio" name="payment-method" value="bank" class="sr-only peer" checked><div class="p-4 border-2 border-gray-200 rounded-xl peer-checked:border-blue-500 peer-checked:bg-blue-50 cursor-pointer"><div class="flex items-center"><div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3"><i class="fas fa-university text-blue-600"></i></div><div><p class="font-medium">Transfer Bank</p><p class="text-sm text-gray-600">BNI, BRI, Mandiri</p></div></div></div></label>
                        <label class="relative"><input type="radio" name="payment-method" value="gopay" class="sr-only peer"><div class="p-4 border-2 border-gray-200 rounded-xl peer-checked:border-green-500 peer-checked:bg-green-50 cursor-pointer"><div class="flex items-center"><div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-3"><i class="fab fa-gopay text-green-600"></i></div><div><p class="font-medium">Gopay</p><p class="text-sm text-gray-600">Dompet digital</p></div></div></div></label>
                        <label class="relative"><input type="radio" name="payment-method" value="ovo" class="sr-only peer"><div class="p-4 border-2 border-gray-200 rounded-xl peer-checked:border-purple-500 peer-checked:bg-purple-50 cursor-pointer"><div class="flex items-center"><div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center mr-3"><i class="fab fa-ovo text-purple-600"></i></div><div><p class="font-medium">OVO</p><p class="text-sm text-gray-600">Dompet digital</p></div></div></div></label>
                        <label class="relative"><input type="radio" name="payment-method" value="dana" class="sr-only peer"><div class="p-4 border-2 border-gray-200 rounded-xl peer-checked:border-blue-400 peer-checked:bg-blue-50 cursor-pointer"><div class="flex items-center"><div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3"><i class="fab fa-dana text-blue-500"></i></div><div><p class="font-medium">DANA</p><p class="text-sm text-gray-600">Dompet digital</p></div></div></div></label>
                    </div></div>
                    <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4"><div class="flex items-start"><i class="fas fa-info-circle text-yellow-600 mt-1 mr-3"></i><div><p class="text-yellow-800 font-medium">Informasi Pembayaran</p><p class="text-yellow-700 text-sm mt-1">Pembayaran akan diproses dalam 1x24 jam. Simpan bukti pembayaran untuk konfirmasi.</p></div></div></div>
                    <button onclick="processPayment()" class="w-full interactive-btn bg-gradient-to-r from-green-500 to-green-600"><i class="fas fa-credit-card mr-2"></i>Proses Pembayaran</button>
                </div>`;
        }

        function closePaymentModal() { 
            document.getElementById('payment-modal').classList.remove('active'); 
        }
        function processPayment() {
            showLoading(); 
            setTimeout(() => { 
                hideLoading(); 
                closePaymentModal(); 
                showToast('Pembayaran berhasil! SPP Anda telah dilunasi.', 'success');
                const payButton = document.getElementById('spp-pay-button'); 
                if (payButton) { 
                    payButton.disabled = true; 
                    payButton.innerHTML = '<i class="fas fa-check mr-2"></i>Sudah Dibayar'; 
                    payButton.classList.remove('bg-gradient-to-r', 'from-green-500', 'to-green-600'); 
                    payButton.classList.add('bg-gray-400'); 
                }
                const statusBadge = document.querySelector('#spp-result .payment-badge'); 
                if (statusBadge) { 
                    statusBadge.textContent = 'LUNAS'; 
                    statusBadge.className = 'payment-badge paid'; 
                } 
            }, 2000);
        }
    </script>
</body>
</html>
